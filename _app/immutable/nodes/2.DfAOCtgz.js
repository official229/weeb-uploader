import{f as O,a as P,c as Oe}from"../chunks/CTHEc7mS.js";import{E as de,A as V,D as ye,I as f,K as p,J as c,B as a,G as Q,H as ce,C as N,aJ as qe,F as Ce,u as Ie,aH as me,af as ve,aC as mt}from"../chunks/DpPdw_ub.js";import{d as be,e as Re}from"../chunks/D_Kb6Vk8.js";import{p as se,b as Ze,i as K}from"../chunks/DxCQtHkc.js";import{r as oe,s as je,a as Ut}from"../chunks/DofntP01.js";import{c as Bt,s as he,e as ke,Z as qt,B as Ht,i as xe,t as He,A as Se,r as kt,h as Ue,E as Ne,b as Be,T as it,D as Qe,n as lt,F as Ge,q as Yt,j as bt,k as _t,l as yt,m as at,o as Et,v as Kt,w as Wt,x as Zt,G as ut,f as Xt,y as Jt,d as Qt,z as $t,U as Dt}from"../chunks/CU0M1q1c.js";import{s as J}from"../chunks/CI280J2U.js";import{b as xt,A as en}from"../chunks/Cjq1WBUe.js";import{r as wt}from"../chunks/fpgiSszx.js";import{g as tn}from"../chunks/CY2_5vFb.js";const nn=!0,ws=Object.freeze(Object.defineProperty({__proto__:null,prerender:nn},Symbol.toStringTag,{value:"Module"}));var rn=O('<p class="uno-133tx6"> </p>'),sn=O('<div class="uno-1hpqvn"><div class="uno-wfkxha"></div> <p class="uno-133tx6"> </p> <!></div>'),an=O('<div class="uno-0uncsh"><p class="uno-e8d28c"> </p> <p class="uno-4w2as4">Extension: <span class="uno-u618z0"> </span> â†’ Detected type: <span class="uno-u618z0"> </span></p></div>'),on=O('<div class="uno-70vcd5"><p class="uno-iik7i5"> </p> <div class="uno-3yjag0"></div></div>'),ln=O('<div class="uno-h4fy2t"><button><h1 class="uno-21tubf">Folder Selector</h1> <input class="uno-rcrjh3" type="file"/></button> <!> <!></div>');function un(n,t){de(t,!0),Bt({useWebWorkers:!1});let e=se(t,"selectedFiles",15,null),r=se(t,"class",3,""),s=V(null),i=V(!1),o=V(null),d=V(ye([])),l=V(!1);const u=["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/vnd.comicbook+zip","application/zip","application/json","text/xml"],E=["jpg","jpeg","png","gif","webp","cbz","zip","xml"];async function _(v){const m=v.name.split(".").pop()?.toLowerCase();if(!(m==="cbz")&&!(m==="zip"))throw new Error(`Unsupported archive format: ${m}`);console.log(`Extracting ${m} file:`,v.name);const I=new qt(new Ht(v)),T=await I.getEntries(),F=[],h=v.name.replace(/\.(cbz|zip)$/i,""),j=v.webkitRelativePath||v.name;for(const H of T){if(!H.filename||H.directory)continue;N(o,H.filename,!0);const Y=H.filename.split(".").pop()?.toLowerCase();if(!Y||!E.includes(Y))continue;const Z=new TransformStream,ie=new Response(Z.readable).blob();await H.getData(Z.writable);let W=await ie;if(!W.type){const Ee=R(Y);W=new Blob([W],{type:Ee})}const $=H.filename,le=$.split("/").pop()??$,ne=j.includes("/")?`${j.split("/").slice(0,-1).join("/")}/${h}/${$}`:`${h}/${$}`,ue=new File([W],le,{type:W.type});Object.defineProperty(ue,"webkitRelativePath",{value:ne,writable:!1,enumerable:!0,configurable:!0}),F.push(ue)}return await I.close(),N(o,null),F}function R(v){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp"}[v]||"application/octet-stream"}async function B(v){const m=await v.slice(0,12).arrayBuffer(),g=new Uint8Array(m);return g.length>=8&&g[0]===137&&g[1]===80&&g[2]===78&&g[3]===71?"png":g.length>=3&&g[0]===255&&g[1]===216&&g[2]===255?"jpg":g.length>=6&&g[0]===71&&g[1]===73&&g[2]===70&&g[3]===56&&(g[4]===57||g[4]===55)&&g[5]===97?"gif":g.length>=12&&g[0]===82&&g[1]===73&&g[2]===70&&g[3]===70&&g[8]===87&&g[9]===69&&g[10]===66&&g[11]===80?"webp":null}async function G(v){const m=[],g=["jpg","jpeg","png","gif","webp"];for(const x of v){const I=x.name.split(".").pop()?.toLowerCase();if(!I||!g.includes(I))continue;const T=await B(x);if(!T)continue;if((T==="jpeg"?"jpg":T)!==(I==="jpeg"?"jpg":I)){const j=x.webkitRelativePath||x.name;m.push({file:x,path:j,detectedType:T,actualExtension:I})}}return m}async function k(v){N(i,!0),N(d,[],!0);const m=v.target,g=Array.from(m.files??[]),x=g.filter(F=>{const h=F.name.split(".").pop()?.toLowerCase();return h==="cbz"||h==="zip"}),I=g.filter(F=>{const h=F.name.split(".").pop()?.toLowerCase(),j=F.type;return h!=="cbz"&&h!=="zip"&&E.includes(h??"")&&u.includes(j)}),T=[];for(const F of x)try{const h=await _(F);T.push(...h)}catch(h){console.error(`Error extracting ${F.name}:`,h)}e([...I,...T]),console.log("Selected files:",e()),N(i,!1),N(l,!0),N(d,await G(e()),!0),N(l,!1),a(d).length===0&&t.onDone()}function y(v){a(s)?.click()}var z=ln(),C=f(z);C.__click=y;var M=p(f(C),2);M.webkitdirectory=!0,M.multiple=!0,M.__change=k,Ze(M,v=>N(s,v),()=>a(s)),c(C);var q=p(C,2);{var U=v=>{var m=sn(),g=p(f(m),2),x=f(g,!0);c(g);var I=p(g,2);{var T=F=>{var h=rn(),j=f(h,!0);c(h),Q(()=>J(j,a(o))),P(F,h)};K(I,F=>{a(o)&&F(T)})}c(m),Q(()=>J(x,a(i)?"Processing files...":"Validating files...")),P(v,m)};K(q,v=>{(a(i)||a(l))&&v(U)})}var w=p(q,2);{var b=v=>{var m=on(),g=f(m),x=f(g);c(g);var I=p(g,2);ke(I,21,()=>a(d),xe,(T,F)=>{let h=()=>a(F).path,j=()=>a(F).detectedType,H=()=>a(F).actualExtension;var Y=an(),Z=f(Y),ie=f(Z,!0);c(Z);var W=p(Z,2),$=p(f(W)),le=f($);c($);var ne=p($,2),ue=f(ne);c(ne),c(W),c(Y),Q(()=>{J(ie,h()),J(le,`.${H()??""}`),J(ue,`.${j()??""}`)}),P(T,Y)}),c(I),c(m),Q(()=>J(x,`Found ${a(d).length??""} file${a(d).length===1?"":"s"} with incorrect
				extensions:`)),P(v,m)};K(w,v=>{a(d).length>0&&v(b)})}c(z),Q(()=>{he(C,1,`uno-gob8cp ${r()??""}`),C.disabled=a(i)||a(l)}),P(n,z),ce()}be(["click","change"]);var dn=O('<p class="uno-gcb561"> </p>'),cn=O('<p class="uno-db86t5">Validating...</p>'),pn=O('<div class="uno-6sm0q7"><div class="uno-dtn9ds"><p class="uno-bk54g7"> </p> <p class="uno-j9i8ts"> </p></div> <button type="button" class="uno-yltzkr" aria-label="Remove" title="Remove"><div class="uno-oz5j6k"></div></button></div>'),fn=O('<div class="uno-dkzd2u"></div>'),gn=O('<div class="uno-kktp2u"><div class="uno-td2fqv"><div class="uno-dtn9ds"><label for="group-id-input" class="uno-zd69eo">Group ID:</label> <input class="uno-ko9not" id="group-id-input" type="text" placeholder="Enter group ID"/></div> <button class="uno-mx7466" type="button">Add Group</button> <!> <!> <!></div></div>');function vn(n,t){de(t,!0);const e="https://api.weebdex.org/group",r=qe(xt);if(!r)throw new Error("TargetingGroupValidator must be used within a component that provides ApiAuthContext context");const s=qe(He);if(!s)throw new Error("TargetingGroupValidator must be used within a component that provides TargetingState context");let i=V(""),o=V(!1),d=V(null),l=V(null);function u(b,v){if(s.availableScanGroups.find(g=>g.groupId===b))return;const m=new kt;m.groupId=b,m.groupName=v,s.availableScanGroups=[...s.availableScanGroups,m]}function E(b){s.availableScanGroups=s.availableScanGroups.filter(v=>v.groupId!==b)}async function _(){if(!a(i).trim()){N(d,"Please enter a group ID");return}const b=r.apiToken;if(!b){N(d,"No API token found");return}N(o,!0),N(d,null);try{const v=`${e}/${a(i).trim()}`,m=await fetch(v,{headers:{Authorization:`Bearer ${b}`}});if(m.ok){const g=await m.json();N(l,g,!0),u(a(i).trim(),g.name),N(d,null)}else N(d,`Failed to validate series: ${m.status} ${m.statusText}`)}catch(v){N(d,v instanceof Error?v.message:"Failed to validate series",!0)}finally{N(o,!1)}}var R=gn(),B=f(R),G=f(B),k=p(f(G),2);oe(k),c(G);var y=p(G,2);y.__click=_;var z=p(y,2);{var C=b=>{var v=dn(),m=f(v,!0);c(v),Q(()=>J(m,a(d))),P(b,v)};K(z,b=>{a(d)&&b(C)})}var M=p(z,2);{var q=b=>{var v=cn();P(b,v)};K(M,b=>{a(o)&&b(q)})}var U=p(M,2);{var w=b=>{var v=fn();ke(v,21,()=>s.availableScanGroups,xe,(m,g)=>{var x=pn(),I=f(x),T=f(I),F=f(T,!0);c(T);var h=p(T,2),j=f(h,!0);c(h),c(I);var H=p(I,2);H.__click=()=>E(a(g).groupId),c(x),Q(()=>{J(F,a(g).groupId),J(j,a(g).groupName)}),P(m,x)}),c(v),P(b,v)};K(U,b=>{s.availableScanGroups.length>0&&b(w)})}c(B),c(R),Q(()=>{k.disabled=a(o),y.disabled=a(o)}),Se(k,()=>a(i),b=>N(i,b)),P(n,R),ce()}be(["click"]);var hn=O('<img class="uno-nxxp44"/>'),mn=O('<div class="uno-qetgxl"></div>'),bn=O('<div class="uno-iwkknw"></div>'),_n=O('<div class="uno-wh6kcz"><span class="uno-6atr7t">Page deleted</span></div>'),yn=O('<button aria-label="Delete page" class="uno-x6no3p"><div class="uno-hcwd2d"></div></button>'),En=O('<button aria-label="Restore page" class="uno-m81k9t"><div class="uno-60j01b"></div></button>'),wn=O('<div class="uno-ezvmq6"><!> <!> <div class="uno-mb41n8"><span class="uno-6atr7t"> </span></div> <!></div>'),In=O('<div class="uno-2sw5oq"></div>');function Nn(n,t){de(t,!0);let e=se(t,"pages",31,()=>ye([]));function r(d){return URL.createObjectURL(d)}function s(d){e(e()[d].isDeleted=!0,!0)}function i(d){e(e()[d].isDeleted=!1,!0)}var o=In();ke(o,21,e,xe,(d,l,u)=>{var E=wn(),_=f(E);{var R=w=>{var b=hn();Q(v=>{je(b,"src",v),je(b,"alt",a(l).pageName)},[()=>r(a(l).pageFile)]),P(w,b)},B=w=>{var b=Oe(),v=Ce(b);{var m=x=>{var I=mn();P(x,I)},g=x=>{var I=bn();P(x,I)};K(v,x=>{a(l).pageType===Ue.CHAPTER_DEFINITION_FILE?x(m):x(g,!1)},!0)}P(w,b)};K(_,w=>{a(l).pageType===Ue.CHAPTER_PAGE?w(R):w(B,!1)})}var G=p(_,2);{var k=w=>{var b=_n();P(w,b)};K(G,w=>{a(l).isDeleted&&w(k)})}var y=p(G,2),z=f(y),C=f(z,!0);c(z),c(y);var M=p(y,2);{var q=w=>{var b=yn();b.__click=()=>s(u),P(w,b)},U=w=>{var b=En();b.__click=()=>i(u),P(w,b)};K(M,w=>{a(l).isDeleted?w(U,!1):w(q)})}c(E),Q(()=>J(C,a(l).pageName)),P(d,E)}),c(o),P(n,o),ce()}be(["click"]);var Tn=O('<div class="uno-fpe0ok svelte-ytt77r"></div>'),Sn=O('<label><input type="checkbox" class="uno-il5nwu svelte-ytt77r"/> <span class="uno-5vknvn svelte-ytt77r"> </span></label>'),kn=O('<div class="uno-qezd1s svelte-ytt77r">No items available</div>'),xn=O('<div role="presentation"><div class="uno-f4km04 svelte-ytt77r"><button type="button"><span class="svelte-ytt77r">Clear Selection</span></button> <!> <!> <!></div></div>');function Fn(n,t){de(t,!0);let e=se(t,"selectedItems",15,null),r=se(t,"isOpen",15,!0),s=se(t,"class",3,""),i=V(null),o=V(null);function d(){if(!t.buttonRect)return;const k=t.buttonRect,y=window.innerHeight,z=window.innerWidth,C=4,M=256;let q=M;if(a(i)){const x=a(i).getBoundingClientRect().height;q=Math.min(x,M)}const U=y-k.bottom-C,w=k.top-C,b=U<M&&w>U;let v;b?(v=k.top-q-C,v<C&&(v=C)):(v=k.bottom+C,v+q>y&&(v=Math.max(C,y-q-C)));let m=k.left;const g=256;m+g>z&&(m=z-g-C,m<C&&(m=C)),N(o,{top:v,left:m,width:Math.max(k.width,g)},!0)}Ie(()=>{e()===null&&e([])});function l(k){e()===null&&e([]),e().findIndex(z=>z.groupId===k.groupId)>=0?e(e().filter(z=>z.groupId!==k.groupId)):e([...e(),k])}function u(k){return e()===null?!1:e().some(y=>y.groupId===k.groupId)}function E(){e([])}Ie(()=>{if(r()){if(!t.buttonRect){N(o,null);return}requestAnimationFrame(()=>{requestAnimationFrame(()=>{d()})});const k=()=>d(),y=C=>{const M=C.target;a(i)&&!a(i).contains(M)&&(r(!1),t.onClose?.())},z=setTimeout(()=>{window.addEventListener("resize",k),document.addEventListener("click",y,!0)},10);return()=>{clearTimeout(z),window.removeEventListener("resize",k),document.removeEventListener("click",y,!0)}}else N(o,null)});let _=V(!1);Ie(()=>{r()&&a(i)&&!a(_)&&(N(_,!0),requestAnimationFrame(()=>{d()})),r()||N(_,!1)});var R=Oe(),B=Ce(R);{var G=k=>{var y=xn();y.__click=v=>v.stopPropagation();var z=f(y),C=f(z);C.__click=()=>E();var M=p(C,2);{var q=v=>{var m=Tn();P(v,m)};K(M,v=>{t.items.length>0&&v(q)})}var U=p(M,2);ke(U,17,()=>t.items,xe,(v,m)=>{var g=Sn(),x=f(g);oe(x),x.__change=()=>l(a(m));var I=p(x,2),T=f(I,!0);c(I),c(g),Q((F,h)=>{he(g,1,`uno-sxy2vd ${F??""}`,"svelte-ytt77r"),Ut(x,h),J(T,a(m).groupName)},[()=>u(a(m))?"uno-95ezdi":"",()=>u(a(m))]),P(v,g)});var w=p(U,2);{var b=v=>{var m=kn();P(v,m)};K(w,v=>{t.items.length===0&&v(b)})}c(z),c(y),Ze(y,v=>N(i,v),()=>a(i)),Q(()=>{he(y,1,Ne(["uno-q4fwa4",s()]),"svelte-ytt77r"),Be(y,`top: ${a(o).top??""}px; left: ${a(o).left??""}px; width: ${a(o).width??""}px;`),he(C,1,`uno-nxuxc4 ${e()===null||e().length===0?"uno-tjbjo6":""}`,"svelte-ytt77r")}),P(k,y)};K(B,k=>{r()&&a(o)&&k(G)})}P(n,R),ce()}be(["click","change"]);var Cn=O("<div><!></div>"),An=O('<p class="uno-o2ql0b"> </p>'),Pn=O('<p class="uno-6y7fk7">No group</p>'),Rn=O('<div><!> <button type="button" class="uno-f23sus" aria-label="Edit groups"><!></button></div>');function Ft(n,t){de(t,!0);const e=qe(He);if(!e)throw new Error("TargetingEditableGroup must be used within a component that provides TargetingState context");const r=me(()=>e.availableScanGroups);let s=se(t,"groups",15,null),i=V(!1),o=V(null),d=V(!1),l=V(null),u=V(null),E=V(null);function _(){t.chapter&&t.fieldName&&!t.chapter.manuallyEditedFields.has(t.fieldName)&&(t.chapter.originalFieldValues.has(t.fieldName)||t.chapter.originalFieldValues.set(t.fieldName,s().groupIds?[...s().groupIds]:null)),a(u)&&N(E,a(u).getBoundingClientRect(),!0),s().groupIds?N(o,s().groupIds.map(w=>a(r).find(b=>b.groupId===w)).filter(w=>w!==void 0),!0):N(o,[],!0),N(i,!0),N(d,!0),window.addEventListener("keydown",G)}function R(){N(i,!1),N(d,!1),N(E,null),window.removeEventListener("keydown",G),s(s().groupIds=a(o)?.map(w=>w.groupId)??[],!0),t.chapter&&t.fieldName&&t.chapter.manuallyEditedFields.add(t.fieldName)}function B(){R()}function G(w){w.key==="Escape"&&R()}var k=Rn(),y=f(k);{var z=w=>{var b=Cn();b.__click=m=>m.stopPropagation();var v=f(b);Fn(v,{get items(){return a(r)},onClose:B,get buttonRect(){return a(E)},get selectedItems(){return a(o)},set selectedItems(m){N(o,m,!0)},get isOpen(){return a(d)},set isOpen(m){N(d,m,!0)}}),c(b),Ze(b,m=>N(l,m),()=>a(l)),P(w,b)};K(y,w=>{a(i)&&w(z)})}var C=p(y,2);C.__click=w=>{w.stopPropagation(),_()};var M=f(C);{var q=w=>{var b=An(),v=f(b,!0);c(b),Q(m=>J(v,m),[()=>s().groupIds.map(m=>a(r).find(x=>x.groupId===m)?.groupName??m).join(", ")]),P(w,b)},U=w=>{var b=Pn();P(w,b)};K(M,w=>{s().groupIds&&s().groupIds.length>0?w(q):w(U,!1)})}c(C),Ze(C,w=>N(u,w),()=>a(u)),c(k),P(n,k),ce()}be(["click"]);function zn(n){return{en:"gb",af:"za",sq:"al",ar:"sa",az:"az",eu:"es",be:"by",bn:"bd",bg:"bg",my:"mm",ca:"es",zh:"cn","zh-hk":"hk",cv:"ru",hr:"hr",cs:"cz",da:"dk",nl:"nl",eo:"eo",et:"ee",tl:"ph",fi:"fi",fr:"fr",ka:"ge",de:"de",el:"gr",he:"il",hi:"in",hu:"hu",id:"id",jv:"id",ga:"ie",it:"it",ja:"jp",kk:"kz",ko:"kr",la:"va",lt:"lt",ms:"my",mn:"mn",ne:"np",no:"no",fa:"ir",pl:"pl",pt:"pt","pt-br":"br",ro:"ro",ru:"ru",sr:"rs",sk:"sk",sl:"si",es:"es","es-la":"mx",sv:"se",tam:"in",te:"in",th:"th",tr:"tr",uk:"ua",ur:"pk",uz:"uz",vi:"vn"}[n]||n}function On(n){if(n==="eo")return"ðŸŒ";const t=n.toUpperCase().split("").map(e=>127397+e.charCodeAt(0));return String.fromCodePoint(...t)}function jn(n){const t=zn(n);return On(t)}function Ct(n){return`${jn(n.id)} ${n.name}`}const $e=[{id:"en",name:"English"},{id:"af",name:"Afrikaans"},{id:"sq",name:"Albanian"},{id:"ar",name:"Arabic"},{id:"az",name:"Azerbaijani"},{id:"eu",name:"Basque"},{id:"be",name:"Belarusian"},{id:"bn",name:"Bengali"},{id:"bg",name:"Bulgarian"},{id:"my",name:"Burmese"},{id:"ca",name:"Catalan"},{id:"zh",name:"Chinese (Simplified)"},{id:"zh-hk",name:"Chinese (Traditional)"},{id:"cv",name:"Chuvash"},{id:"hr",name:"Croatian"},{id:"cs",name:"Czech"},{id:"da",name:"Danish"},{id:"nl",name:"Dutch"},{id:"eo",name:"Esperanto"},{id:"et",name:"Estonian"},{id:"tl",name:"Filipino"},{id:"fi",name:"Finish"},{id:"fr",name:"French"},{id:"ka",name:"Georgian"},{id:"de",name:"German"},{id:"el",name:"Greek"},{id:"he",name:"Hebrew"},{id:"hi",name:"Hindi"},{id:"hu",name:"Hungarian"},{id:"id",name:"Indonesian"},{id:"jv",name:"Javanese"},{id:"ga",name:"Irish"},{id:"it",name:"Italian"},{id:"ja",name:"Japanese"},{id:"kk",name:"Kazakh"},{id:"ko",name:"Korean"},{id:"la",name:"Latin"},{id:"lt",name:"Lithuanian"},{id:"ms",name:"Malay"},{id:"mn",name:"Mongolian"},{id:"ne",name:"Nepali"},{id:"no",name:"Norwegian"},{id:"fa",name:"Persian"},{id:"pl",name:"Polish"},{id:"pt",name:"Portuguese"},{id:"pt-br",name:"Portuguese (Brazil)"},{id:"ro",name:"Romanian"},{id:"ru",name:"Russian"},{id:"sr",name:"Serbian"},{id:"sk",name:"Slovak"},{id:"sl",name:"Slovenian"},{id:"es",name:"Spanish"},{id:"es-la",name:"Spanish (LATAM)"},{id:"sv",name:"Swedish"},{id:"tam",name:"Tamil"},{id:"te",name:"Telugu"},{id:"th",name:"Thai"},{id:"tr",name:"Turkish"},{id:"uk",name:"Ukranian"},{id:"ur",name:"Urdu"},{id:"uz",name:"Uzbek"},{id:"vi",name:"Vietnamese"}];var Vn=O('<button type="button" class="uno-erk55q" title="Revert manual edit"><div class="uno-jugmv0"></div></button>'),Gn=O('<button type="button" class="uno-erk55q" title="Revert manual edit"><div class="uno-jugmv0"></div></button>'),Ln=O('<button type="button" class="uno-erk55q" title="Revert manual edit"><div class="uno-jugmv0"></div></button>'),Mn=O('<button type="button" class="uno-erk55q" title="Revert manual edit"><div class="uno-jugmv0"></div></button>'),Un=O('<button type="button" class="uno-erk55q" title="Revert manual edit"><div class="uno-jugmv0"></div></button>'),Bn=O('<div class="uno-ax06g0"></div>'),qn=O('<div class="uno-d9abuh"></div>'),Hn=O('<div aria-label="Collapse" class="uno-wx2jg6"></div>'),Yn=O('<div aria-label="Expand" class="uno-op2jdb"></div>'),Kn=O('<div class="uno-rw00hm"><!></div>'),Wn=O('<div><div class="uno-e2gvxs"><div class="uno-j7zfdb"><div class="uno-h58bnc"><span class="uno-54xv4y"> </span> <div class="uno-h58bnc"><span class="uno-vv4s5f">Vol.</span> <!> <!></div> <div class="uno-h58bnc"><span class="uno-vv4s5f">Ch.</span> <!> <!></div> <div class="uno-h58bnc"><span class="uno-vv4s5f">Groups:</span> <!> <!></div></div> <div class="uno-h58bnc"><span class="uno-vv4s5f">Original:</span> <p class="uno-vv4s5f"> </p></div> <div class="uno-h58bnc"><span class="uno-vv4s5f">Title:</span> <!> <!></div> <div class="uno-h58bnc"><span class="uno-vv4s5f">Language:</span> <!> <!></div></div> <button type="button" class="uno-khevc7" title="Delete chapter"><!></button> <button type="button" class="uno-as3ag3"><!></button></div> <!></div>');function Zn(n,t){if(de(t,!0),!qe(He))throw new Error("TargetedChapterEditor must be used within a component that provides TargetingState context");const r=se(t,"chapter",15);let s=V(!1),i=V(!1);Ie(()=>{!a(i)&&r()&&(r().originalFieldValues.has("language")||r().originalFieldValues.set("language",r().language),N(i,!0))}),Ie(()=>{if(a(i)&&r()&&r().originalFieldValues.has("language")){const A=r().originalFieldValues.get("language");r().language!==A&&!r().manuallyEditedFields.has("language")&&r().manuallyEditedFields.add("language")}});function o(){N(s,!a(s))}function d(A){if(r().originalFieldValues.has(A)){const L=r().originalFieldValues.get(A);A==="title"?r(r().chapterTitle=L,!0):A==="volume"?r(r().chapterVolume=L,!0):A==="chapterNumber"?r(r().chapterNumber=L,!0):A==="groups"?r(r().associatedGroup.groupIds=L?[...L]:null,!0):A==="language"&&r(r().language=L,!0),r().manuallyEditedFields.delete(A),r().originalFieldValues.delete(A)}}function l(){r(r().isDeleted=!r().isDeleted,!0)}var u=Wn(),E=f(u),_=f(E),R=f(_),B=f(R),G=f(B);c(B);var k=p(B,2),y=p(f(k),2);it(y,{textClass:"text-sm text-muted",fieldName:"volume",get chapter(){return r()},get value(){return r().chapterVolume},set value(A){r(r().chapterVolume=A,!0)}});var z=p(y,2);{var C=A=>{var L=Vn();L.__click=ee=>{ee.stopPropagation(),d("volume")},P(A,L)};K(z,A=>{r().manuallyEditedFields.has("volume")&&A(C)})}c(k);var M=p(k,2),q=p(f(M),2);it(q,{textClass:"text-sm text-muted",fieldName:"chapterNumber",get chapter(){return r()},get value(){return r().chapterNumber},set value(A){r(r().chapterNumber=A,!0)}});var U=p(q,2);{var w=A=>{var L=Gn();L.__click=ee=>{ee.stopPropagation(),d("chapterNumber")},P(A,L)};K(U,A=>{r().manuallyEditedFields.has("chapterNumber")&&A(w)})}c(M);var b=p(M,2),v=p(f(b),2);Ft(v,{fieldName:"groups",get chapter(){return r()},get groups(){return r().associatedGroup},set groups(A){r(r().associatedGroup=A,!0)}});var m=p(v,2);{var g=A=>{var L=Ln();L.__click=ee=>{ee.stopPropagation(),d("groups")},P(A,L)};K(m,A=>{r().manuallyEditedFields.has("groups")&&A(g)})}c(b),c(R);var x=p(R,2),I=p(f(x),2),T=f(I,!0);c(I),c(x);var F=p(x,2),h=p(f(F),2);it(h,{class:"",textClass:"text-xl font-bold text-app",fieldName:"title",get chapter(){return r()},get value(){return r().chapterTitle},set value(A){r(r().chapterTitle=A,!0)}});var j=p(h,2);{var H=A=>{var L=Mn();L.__click=ee=>{ee.stopPropagation(),d("title")},P(A,L)};K(j,A=>{r().manuallyEditedFields.has("title")&&A(H)})}c(F);var Y=p(F,2),Z=p(f(Y),2);{let A=me(()=>$e.map(L=>L.id));Qe(Z,{get items(){return a(A)},getDisplayText:L=>{const ee=$e.find(Ae=>Ae.id===L);return ee?Ct(ee):L},class:"uno-6nex0u",get selectedItem(){return r().language},set selectedItem(L){r(r().language=L,!0)}})}var ie=p(Z,2);{var W=A=>{var L=Un();L.__click=ee=>{ee.stopPropagation(),d("language")},P(A,L)};K(ie,A=>{r().manuallyEditedFields.has("language")&&A(W)})}c(Y),c(_);var $=p(_,2);$.__click=l;var le=f($);{var ne=A=>{var L=Bn();P(A,L)},ue=A=>{var L=qn();P(A,L)};K(le,A=>{r().isDeleted?A(ne):A(ue,!1)})}c($);var Ee=p($,2);Ee.__click=o;var Le=f(Ee);{var Ye=A=>{var L=Hn();P(A,L)},Fe=A=>{var L=Yn();P(A,L)};K(Le,A=>{a(s)?A(Ye):A(Fe,!1)})}c(Ee),c(E);var we=p(E,2);{var Te=A=>{var L=Kn(),ee=f(L);Nn(ee,{get pages(){return r().pages},set pages(Ae){r(r().pages=Ae,!0)}}),c(L),P(A,L)};K(we,A=>{a(s)&&A(Te)})}c(u),Q(()=>{he(u,1,Ne(["uno-gqkv0r",t.class])),J(G,`${t.index+1}.`),J(T,r().originalFolderPath)}),P(n,u),ce()}be(["click"]);var Xn=O('<div class="uno-am3dzj"><p>Range:</p> <input type="number" placeholder="Start" class="uno-bp9lvd"/> <p>to</p> <input type="number" placeholder="End" class="uno-bp9lvd"/></div>');function Me(n,t){de(t,!0);let e=se(t,"rangeStart",15,null),r=se(t,"rangeEnd",15,null);Ie(()=>{e()!==null&&r()!==null&&r()<e()&&r(e())});var s=Xn(),i=p(f(s),2);oe(i);var o=p(i,4);oe(o),c(s),Q((d,l)=>{je(i,"min",t.min),je(i,"max",d),je(o,"min",l),je(o,"max",t.max)},[()=>r()!==null?Math.min(t.max,r()):t.max,()=>e()!==null?Math.max(t.min,e()):t.min]),Se(i,e),Se(o,r),P(n,s),ce()}var Jn=O(`<div class="uno-hv8hef"><p class="uno-nt4u1e">Here you have the ability to batch apply changes to all chapters at once. <br/> For title / volume / chapter number extraction, Regex is used, where the first capture group will
		be used to set the value. You can use as many non-capturing groups as you want, and they will be
		ignored. <br/> Should batch editing not be enough, you can manually edit each chapter property individually by clicking
		on it, including removing pages (click on a chapter and it'll expand to show the pages). <br/> You are also able to assign groups to chapters, but for this you first need to register them with
		Group Preparation above. <br/> Groups will be applied to all chapters by default, or to the range if specified (values are inclusive) <br/> Some regexes are prefilled for you, but you can change them for your specific needs.</p> <div class="uno-iuzx0s"><p class="uno-tfn8jv">Quick unfuckup actions:</p> <button type="button" class="uno-c8n574">Clear Titles</button> <button type="button" class="uno-c8n574">Reset Titles</button></div> <form class="uno-vr0h6j"><div class="uno-6patty"><p class="uno-tfn8jv">Extract Title Regex:</p> <input type="text" placeholder="^(.+?)\\s+-\\s+Vol" class="uno-d22hha"/></div> <div class="uno-3lkpn9"><label class="uno-yrku2g"><input type="checkbox" class="uno-0xzuhw"/> <span class="uno-nt4u1e">Case Sensitive</span></label> <!> <button type="submit" class="uno-160w63">Apply</button></div></form> <form class="uno-vr0h6j"><div class="uno-6patty"><p class="uno-tfn8jv">Extract Volume Regex:</p> <input type="text" placeholder="Vol\\.? ?(\\d+)" class="uno-d22hha"/></div> <div class="uno-3lkpn9"><label class="uno-yrku2g"><input type="checkbox" class="uno-0xzuhw"/> <span class="uno-nt4u1e">Case Sensitive</span></label> <!> <button type="submit" class="uno-160w63">Apply</button></div></form> <form class="uno-vr0h6j"><div class="uno-6patty"><p class="uno-tfn8jv">Extract Chapter Number Regex:</p> <input type="text" placeholder="Ch\\.? ?(\\d+)" class="uno-d22hha"/></div> <div class="uno-3lkpn9"><label class="uno-yrku2g"><input type="checkbox" class="uno-0xzuhw"/> <span class="uno-nt4u1e">Case Sensitive</span></label> <!> <button type="submit" class="uno-160w63">Apply</button></div></form> <form class="uno-vr0h6j"><div class="uno-3lkpn9"><p class="uno-tfn8jv">Assign Volume to All Chapters:</p> <input type="text" placeholder="Volume number" class="uno-gz6zwy"/></div> <div class="uno-3lkpn9"><!> <button type="submit" class="uno-160w63">Apply</button></div></form> <form class="uno-vr0h6j"><div class="uno-3lkpn9"><p class="uno-tfn8jv">Assign Language to All Chapters:</p> <!></div> <div class="uno-3lkpn9"><!> <button type="submit" class="uno-160w63">Apply</button></div></form> <form class="uno-vr0h6j"><div class="uno-h5li09"><p class="uno-tfn8jv">Assign Groups to All Chapters:</p> <!></div> <div class="uno-3lkpn9"><!> <button type="submit" class="uno-160w63">Set Group(s)</button> <button type="button" class="uno-160w63">Append Group(s)</button></div></form></div>`);function Qn(n,t){de(t,!0);let e=se(t,"chapters",27,()=>ye([])),r=V("- (.+)$"),s=V(!1),i=V("Vol\\.? ?(\\d+)"),o=V(!1),d=V("(?:Ch\\.?|Chapter) ?(\\d+(?:\\.\\d+)?)"),l=V(!1),u=V(ye(new lt)),E=V(null),_=V("en");const R=ye({start:null,end:null}),B=ye({start:null,end:null}),G=ye({start:null,end:null}),k=ye({start:null,end:null}),y=ye({start:null,end:null}),z=ye({start:null,end:null});function C(){if(!a(r).trim())return;const S=a(s)?"":"i",re=new RegExp(a(r),S),ae=(k.start??1)-1,D=(k.end??e().length)-1;for(let X=ae;X<=D;X++){const pe=e()[X];if(!pe.originalFolderPath||pe.manuallyEditedFields.has("title"))continue;const _e=pe.originalFolderPath.match(re);_e&&_e[1]&&(pe.chapterTitle=_e[1])}}function M(){if(!a(i).trim())return;const S=a(o)?"":"i",re=new RegExp(a(i),S),ae=(y.start??1)-1,D=(y.end??e().length)-1;for(let X=ae;X<=D;X++){const pe=e()[X];if(!pe.originalFolderPath||pe.manuallyEditedFields.has("volume"))continue;const _e=pe.originalFolderPath.match(re);_e&&_e[1]&&(pe.chapterVolume=_e[1].replace(/^0+/,""))}}function q(){if(!a(d).trim())return;const S=a(l)?"":"i",re=new RegExp(a(d),S),ae=(z.start??1)-1,D=(z.end??e().length)-1;for(let X=ae;X<=D;X++){const pe=e()[X];if(!pe.originalFolderPath||pe.manuallyEditedFields.has("chapterNumber"))continue;const _e=pe.originalFolderPath.match(re);_e&&_e[1]&&(pe.chapterNumber=_e[1].replace(/^0+/,""))}}function U(){e().forEach(S=>{S.manuallyEditedFields.has("title")||(S.chapterTitle=S.originalFolderPath?.split("/").pop()??"")})}function w(){e().forEach(S=>{S.manuallyEditedFields.has("title")||(S.chapterTitle="")})}function b(){const S=(R.start??1)-1,re=(R.end??e().length)-1,ae=a(u).groupIds??[];for(let D=S;D<=re;D++){const X=e()[D];X.manuallyEditedFields.has("groups")||(X.associatedGroup.groupIds=[...ae])}}function v(){const S=(R.start??1)-1,re=(R.end??e().length)-1,ae=a(u).groupIds??[];for(let D=S;D<=re;D++){const X=e()[D];if(X.manuallyEditedFields.has("groups"))continue;const _e=[...X.associatedGroup.groupIds??[],...ae],Mt=[...new Set(_e)];X.associatedGroup.groupIds=Mt}}function m(){const S=(B.start??1)-1,re=(B.end??e().length)-1,ae=a(E)?.trim()||null;for(let D=S;D<=re;D++){const X=e()[D];X.manuallyEditedFields.has("volume")||(X.chapterVolume=ae)}}function g(){const S=(G.start??1)-1,re=(G.end??e().length)-1,ae=a(_)?.trim()||"en";for(let D=S;D<=re;D++){const X=e()[D];X.manuallyEditedFields.has("language")||(X.originalFieldValues.set("language",ae),X.language=ae,X.manuallyEditedFields.delete("language"))}}var x=Jn(),I=p(f(x),2),T=p(f(I),2);T.__click=w;var F=p(T,2);F.__click=U,c(I);var h=p(I,2),j=f(h),H=p(f(j),2);oe(H),c(j);var Y=p(j,2),Z=f(Y),ie=f(Z);oe(ie),ve(2),c(Z);var W=p(Z,2);Me(W,{min:1,get max(){return e().length},get rangeStart(){return k.start},set rangeStart(S){k.start=S},get rangeEnd(){return k.end},set rangeEnd(S){k.end=S}}),ve(2),c(Y),c(h);var $=p(h,2),le=f($),ne=p(f(le),2);oe(ne),c(le);var ue=p(le,2),Ee=f(ue),Le=f(Ee);oe(Le),ve(2),c(Ee);var Ye=p(Ee,2);Me(Ye,{min:1,get max(){return e().length},get rangeStart(){return y.start},set rangeStart(S){y.start=S},get rangeEnd(){return y.end},set rangeEnd(S){y.end=S}}),ve(2),c(ue),c($);var Fe=p($,2),we=f(Fe),Te=p(f(we),2);oe(Te),c(we);var A=p(we,2),L=f(A),ee=f(L);oe(ee),ve(2),c(L);var Ae=p(L,2);Me(Ae,{min:1,get max(){return e().length},get rangeStart(){return z.start},set rangeStart(S){z.start=S},get rangeEnd(){return z.end},set rangeEnd(S){z.end=S}}),ve(2),c(A),c(Fe);var Xe=p(Fe,2),tt=f(Xe),pt=p(f(tt),2);oe(pt),c(tt);var ft=p(tt,2),Ot=f(ft);Me(Ot,{min:1,get max(){return e().length},get rangeStart(){return B.start},set rangeStart(S){B.start=S},get rangeEnd(){return B.end},set rangeEnd(S){B.end=S}}),ve(2),c(ft),c(Xe);var Je=p(Xe,2),nt=f(Je),jt=p(f(nt),2);{let S=me(()=>$e.map(re=>re.id));Qe(jt,{get items(){return a(S)},getDisplayText:re=>{const ae=$e.find(D=>D.id===re);return ae?Ct(ae):re},class:"uno-c18fgf",get selectedItem(){return a(_)},set selectedItem(re){N(_,re,!0)}})}c(nt);var gt=p(nt,2),Vt=f(gt);Me(Vt,{min:1,get max(){return e().length},get rangeStart(){return G.start},set rangeStart(S){G.start=S},get rangeEnd(){return G.end},set rangeEnd(S){G.end=S}}),ve(2),c(gt),c(Je);var rt=p(Je,2),st=f(rt),Gt=p(f(st),2);Ft(Gt,{get groups(){return a(u)},set groups(S){N(u,S,!0)}}),c(st);var vt=p(st,2),ht=f(vt);Me(ht,{min:1,get max(){return e().length},get rangeStart(){return R.start},set rangeStart(S){R.start=S},get rangeEnd(){return R.end},set rangeEnd(S){R.end=S}});var Lt=p(ht,4);Lt.__click=v,c(vt),c(rt),c(x),Re("submit",h,S=>{C(),S.preventDefault()}),Se(H,()=>a(r),S=>N(r,S)),Ge(ie,()=>a(s),S=>N(s,S)),Re("submit",$,S=>{M(),S.preventDefault()}),Se(ne,()=>a(i),S=>N(i,S)),Ge(Le,()=>a(o),S=>N(o,S)),Re("submit",Fe,S=>{q(),S.preventDefault()}),Se(Te,()=>a(d),S=>N(d,S)),Ge(ee,()=>a(l),S=>N(l,S)),Re("submit",Xe,S=>{m(),S.preventDefault()}),Se(pt,()=>a(E),S=>N(E,S)),Re("submit",Je,S=>{g(),S.preventDefault()}),Re("submit",rt,S=>{b(),S.preventDefault()}),P(n,x),ce()}be(["click"]);const At=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",$n=At+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",Dn="["+At+"]["+$n+"]*",er=new RegExp("^"+Dn+"$");function Pt(n,t){const e=[];let r=t.exec(n);for(;r;){const s=[];s.startIndex=t.lastIndex-r[0].length;const i=r.length;for(let o=0;o<i;o++)s.push(r[o]);e.push(s),r=t.exec(n)}return e}const et=function(n){const t=er.exec(n);return!(t===null||typeof t>"u")};function tr(n){return typeof n<"u"}const nr={allowBooleanAttributes:!1,unpairedTags:[]};function rr(n,t){t=Object.assign({},nr,t);const e=[];let r=!1,s=!1;n[0]==="\uFEFF"&&(n=n.substr(1));for(let i=0;i<n.length;i++)if(n[i]==="<"&&n[i+1]==="?"){if(i+=2,i=Nt(n,i),i.err)return i}else if(n[i]==="<"){let o=i;if(i++,n[i]==="!"){i=Tt(n,i);continue}else{let d=!1;n[i]==="/"&&(d=!0,i++);let l="";for(;i<n.length&&n[i]!==">"&&n[i]!==" "&&n[i]!=="	"&&n[i]!==`
`&&n[i]!=="\r";i++)l+=n[i];if(l=l.trim(),l[l.length-1]==="/"&&(l=l.substring(0,l.length-1),i--),!cr(l)){let _;return l.trim().length===0?_="Invalid space after '<'.":_="Tag '"+l+"' is an invalid name.",te("InvalidTag",_,fe(n,i))}const u=ar(n,i);if(u===!1)return te("InvalidAttr","Attributes for '"+l+"' have open quote.",fe(n,i));let E=u.value;if(i=u.index,E[E.length-1]==="/"){const _=i-E.length;E=E.substring(0,E.length-1);const R=St(E,t);if(R===!0)r=!0;else return te(R.err.code,R.err.msg,fe(n,_+R.err.line))}else if(d)if(u.tagClosed){if(E.trim().length>0)return te("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",fe(n,o));if(e.length===0)return te("InvalidTag","Closing tag '"+l+"' has not been opened.",fe(n,o));{const _=e.pop();if(l!==_.tagName){let R=fe(n,_.tagStartPos);return te("InvalidTag","Expected closing tag '"+_.tagName+"' (opened in line "+R.line+", col "+R.col+") instead of closing tag '"+l+"'.",fe(n,o))}e.length==0&&(s=!0)}}else return te("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",fe(n,i));else{const _=St(E,t);if(_!==!0)return te(_.err.code,_.err.msg,fe(n,i-E.length+_.err.line));if(s===!0)return te("InvalidXml","Multiple possible root nodes found.",fe(n,i));t.unpairedTags.indexOf(l)!==-1||e.push({tagName:l,tagStartPos:o}),r=!0}for(i++;i<n.length;i++)if(n[i]==="<")if(n[i+1]==="!"){i++,i=Tt(n,i);continue}else if(n[i+1]==="?"){if(i=Nt(n,++i),i.err)return i}else break;else if(n[i]==="&"){const _=ur(n,i);if(_==-1)return te("InvalidChar","char '&' is not expected.",fe(n,i));i=_}else if(s===!0&&!It(n[i]))return te("InvalidXml","Extra text at the end",fe(n,i));n[i]==="<"&&i--}}else{if(It(n[i]))continue;return te("InvalidChar","char '"+n[i]+"' is not expected.",fe(n,i))}if(r){if(e.length==1)return te("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",fe(n,e[0].tagStartPos));if(e.length>0)return te("InvalidXml","Invalid '"+JSON.stringify(e.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return te("InvalidXml","Start tag expected.",1);return!0}function It(n){return n===" "||n==="	"||n===`
`||n==="\r"}function Nt(n,t){const e=t;for(;t<n.length;t++)if(n[t]=="?"||n[t]==" "){const r=n.substr(e,t-e);if(t>5&&r==="xml")return te("InvalidXml","XML declaration allowed only at the start of the document.",fe(n,t));if(n[t]=="?"&&n[t+1]==">"){t++;break}else continue}return t}function Tt(n,t){if(n.length>t+5&&n[t+1]==="-"&&n[t+2]==="-"){for(t+=3;t<n.length;t++)if(n[t]==="-"&&n[t+1]==="-"&&n[t+2]===">"){t+=2;break}}else if(n.length>t+8&&n[t+1]==="D"&&n[t+2]==="O"&&n[t+3]==="C"&&n[t+4]==="T"&&n[t+5]==="Y"&&n[t+6]==="P"&&n[t+7]==="E"){let e=1;for(t+=8;t<n.length;t++)if(n[t]==="<")e++;else if(n[t]===">"&&(e--,e===0))break}else if(n.length>t+9&&n[t+1]==="["&&n[t+2]==="C"&&n[t+3]==="D"&&n[t+4]==="A"&&n[t+5]==="T"&&n[t+6]==="A"&&n[t+7]==="["){for(t+=8;t<n.length;t++)if(n[t]==="]"&&n[t+1]==="]"&&n[t+2]===">"){t+=2;break}}return t}const sr='"',ir="'";function ar(n,t){let e="",r="",s=!1;for(;t<n.length;t++){if(n[t]===sr||n[t]===ir)r===""?r=n[t]:r!==n[t]||(r="");else if(n[t]===">"&&r===""){s=!0;break}e+=n[t]}return r!==""?!1:{value:e,index:t,tagClosed:s}}const or=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function St(n,t){const e=Pt(n,or),r={};for(let s=0;s<e.length;s++){if(e[s][1].length===0)return te("InvalidAttr","Attribute '"+e[s][2]+"' has no space in starting.",Ke(e[s]));if(e[s][3]!==void 0&&e[s][4]===void 0)return te("InvalidAttr","Attribute '"+e[s][2]+"' is without value.",Ke(e[s]));if(e[s][3]===void 0&&!t.allowBooleanAttributes)return te("InvalidAttr","boolean attribute '"+e[s][2]+"' is not allowed.",Ke(e[s]));const i=e[s][2];if(!dr(i))return te("InvalidAttr","Attribute '"+i+"' is an invalid name.",Ke(e[s]));if(!r.hasOwnProperty(i))r[i]=1;else return te("InvalidAttr","Attribute '"+i+"' is repeated.",Ke(e[s]))}return!0}function lr(n,t){let e=/\d/;for(n[t]==="x"&&(t++,e=/[\da-fA-F]/);t<n.length;t++){if(n[t]===";")return t;if(!n[t].match(e))break}return-1}function ur(n,t){if(t++,n[t]===";")return-1;if(n[t]==="#")return t++,lr(n,t);let e=0;for(;t<n.length;t++,e++)if(!(n[t].match(/\w/)&&e<20)){if(n[t]===";")break;return-1}return t}function te(n,t,e){return{err:{code:n,msg:t,line:e.line||e,col:e.col}}}function dr(n){return et(n)}function cr(n){return et(n)}function fe(n,t){const e=n.substring(0,t).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function Ke(n){return n.startIndex+n[1].length}const pr={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,t){return t},attributeValueProcessor:function(n,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,t,e){return n},captureMetaData:!1},fr=function(n){return Object.assign({},pr,n)};let De;typeof Symbol!="function"?De="@@xmlMetadata":De=Symbol("XML Node Metadata");class ze{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t,e){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child}),e!==void 0&&(this.child[this.child.length-1][De]={startIndex:e})}static getMetaDataSymbol(){return De}}class gr{constructor(t){this.suppressValidationErr=!t}readDocType(t,e){const r={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let s=1,i=!1,o=!1,d="";for(;e<t.length;e++)if(t[e]==="<"&&!o){if(i&&Pe(t,"!ENTITY",e)){e+=7;let l,u;[l,u,e]=this.readEntityExp(t,e+1,this.suppressValidationErr),u.indexOf("&")===-1&&(r[l]={regx:RegExp(`&${l};`,"g"),val:u})}else if(i&&Pe(t,"!ELEMENT",e)){e+=8;const{index:l}=this.readElementExp(t,e+1);e=l}else if(i&&Pe(t,"!ATTLIST",e))e+=8;else if(i&&Pe(t,"!NOTATION",e)){e+=9;const{index:l}=this.readNotationExp(t,e+1,this.suppressValidationErr);e=l}else if(Pe(t,"!--",e))o=!0;else throw new Error("Invalid DOCTYPE");s++,d=""}else if(t[e]===">"){if(o?t[e-1]==="-"&&t[e-2]==="-"&&(o=!1,s--):s--,s===0)break}else t[e]==="["?i=!0:d+=t[e];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:e}}readEntityExp(t,e){e=ge(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e])&&t[e]!=='"'&&t[e]!=="'";)r+=t[e],e++;if(We(r),e=ge(t,e),!this.suppressValidationErr){if(t.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(t[e]==="%")throw new Error("Parameter entities are not supported")}let s="";return[e,s]=this.readIdentifierVal(t,e,"entity"),e--,[r,s,e]}readNotationExp(t,e){e=ge(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;!this.suppressValidationErr&&We(r),e=ge(t,e);const s=t.substring(e,e+6).toUpperCase();if(!this.suppressValidationErr&&s!=="SYSTEM"&&s!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${s}"`);e+=s.length,e=ge(t,e);let i=null,o=null;if(s==="PUBLIC")[e,i]=this.readIdentifierVal(t,e,"publicIdentifier"),e=ge(t,e),(t[e]==='"'||t[e]==="'")&&([e,o]=this.readIdentifierVal(t,e,"systemIdentifier"));else if(s==="SYSTEM"&&([e,o]=this.readIdentifierVal(t,e,"systemIdentifier"),!this.suppressValidationErr&&!o))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:r,publicIdentifier:i,systemIdentifier:o,index:--e}}readIdentifierVal(t,e,r){let s="";const i=t[e];if(i!=='"'&&i!=="'")throw new Error(`Expected quoted string, found "${i}"`);for(e++;e<t.length&&t[e]!==i;)s+=t[e],e++;if(t[e]!==i)throw new Error(`Unterminated ${r} value`);return e++,[e,s]}readElementExp(t,e){e=ge(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;if(!this.suppressValidationErr&&!et(r))throw new Error(`Invalid element name: "${r}"`);e=ge(t,e);let s="";if(t[e]==="E"&&Pe(t,"MPTY",e))e+=4;else if(t[e]==="A"&&Pe(t,"NY",e))e+=2;else if(t[e]==="("){for(e++;e<t.length&&t[e]!==")";)s+=t[e],e++;if(t[e]!==")")throw new Error("Unterminated content model")}else if(!this.suppressValidationErr)throw new Error(`Invalid Element Expression, found "${t[e]}"`);return{elementName:r,contentModel:s.trim(),index:e}}readAttlistExp(t,e){e=ge(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;We(r),e=ge(t,e);let s="";for(;e<t.length&&!/\s/.test(t[e]);)s+=t[e],e++;if(!We(s))throw new Error(`Invalid attribute name: "${s}"`);e=ge(t,e);let i="";if(t.substring(e,e+8).toUpperCase()==="NOTATION"){if(i="NOTATION",e+=8,e=ge(t,e),t[e]!=="(")throw new Error(`Expected '(', found "${t[e]}"`);e++;let d=[];for(;e<t.length&&t[e]!==")";){let l="";for(;e<t.length&&t[e]!=="|"&&t[e]!==")";)l+=t[e],e++;if(l=l.trim(),!We(l))throw new Error(`Invalid notation name: "${l}"`);d.push(l),t[e]==="|"&&(e++,e=ge(t,e))}if(t[e]!==")")throw new Error("Unterminated list of notations");e++,i+=" ("+d.join("|")+")"}else{for(;e<t.length&&!/\s/.test(t[e]);)i+=t[e],e++;const d=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!d.includes(i.toUpperCase()))throw new Error(`Invalid attribute type: "${i}"`)}e=ge(t,e);let o="";return t.substring(e,e+8).toUpperCase()==="#REQUIRED"?(o="#REQUIRED",e+=8):t.substring(e,e+7).toUpperCase()==="#IMPLIED"?(o="#IMPLIED",e+=7):[e,o]=this.readIdentifierVal(t,e,"ATTLIST"),{elementName:r,attributeName:s,attributeType:i,defaultValue:o,index:e}}}const ge=(n,t)=>{for(;t<n.length&&/\s/.test(n[t]);)t++;return t};function Pe(n,t,e){for(let r=0;r<t.length;r++)if(t[r]!==n[e+r+1])return!1;return!0}function We(n){if(et(n))return n;throw new Error(`Invalid entity name ${n}`)}const vr=/^[-+]?0x[a-fA-F0-9]+$/,hr=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,mr={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function br(n,t={}){if(t=Object.assign({},mr,t),!n||typeof n!="string")return n;let e=n.trim();if(t.skipLike!==void 0&&t.skipLike.test(e))return n;if(n==="0")return 0;if(t.hex&&vr.test(e))return wr(e,16);if(e.search(/.+[eE].+/)!==-1)return yr(n,e,t);{const r=hr.exec(e);if(r){const s=r[1]||"",i=r[2];let o=Er(r[3]);const d=s?n[i.length+1]===".":n[i.length]===".";if(!t.leadingZeros&&(i.length>1||i.length===1&&!d))return n;{const l=Number(e),u=String(l);if(l===0)return l;if(u.search(/[eE]/)!==-1)return t.eNotation?l:n;if(e.indexOf(".")!==-1)return u==="0"||u===o||u===`${s}${o}`?l:n;let E=i?o:e;return i?E===u||s+E===u?l:n:E===u||E===s+u?l:n}}else return n}}const _r=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function yr(n,t,e){if(!e.eNotation)return n;const r=t.match(_r);if(r){let s=r[1]||"";const i=r[3].indexOf("e")===-1?"E":"e",o=r[2],d=s?n[o.length+1]===i:n[o.length]===i;return o.length>1&&d?n:o.length===1&&(r[3].startsWith(`.${i}`)||r[3][0]===i)?Number(t):e.leadingZeros&&!d?(t=(r[1]||"")+r[3],Number(t)):n}else return n}function Er(n){return n&&n.indexOf(".")!==-1&&(n=n.replace(/0+$/,""),n==="."?n="0":n[0]==="."?n="0"+n:n[n.length-1]==="."&&(n=n.substring(0,n.length-1))),n}function wr(n,t){if(parseInt)return parseInt(n,t);if(Number.parseInt)return Number.parseInt(n,t);if(window&&window.parseInt)return window.parseInt(n,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function Ir(n){return typeof n=="function"?n:Array.isArray(n)?t=>{for(const e of n)if(typeof e=="string"&&t===e||e instanceof RegExp&&e.test(t))return!0}:()=>!1}class Nr{constructor(t){if(this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"Â¢"},pound:{regex:/&(pound|#163);/g,val:"Â£"},yen:{regex:/&(yen|#165);/g,val:"Â¥"},euro:{regex:/&(euro|#8364);/g,val:"â‚¬"},copyright:{regex:/&(copy|#169);/g,val:"Â©"},reg:{regex:/&(reg|#174);/g,val:"Â®"},inr:{regex:/&(inr|#8377);/g,val:"â‚¹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,r)=>String.fromCodePoint(Number.parseInt(r,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,r)=>String.fromCodePoint(Number.parseInt(r,16))}},this.addExternalEntities=Tr,this.parseXml=Cr,this.parseTextData=Sr,this.resolveNameSpace=kr,this.buildAttributesMap=Fr,this.isItStopNode=zr,this.replaceEntitiesValue=Pr,this.readStopNodeData=jr,this.saveTextToParentTag=Rr,this.addChild=Ar,this.ignoreAttributesFn=Ir(this.options.ignoreAttributes),this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set,this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){const r=this.options.stopNodes[e];typeof r=="string"&&(r.startsWith("*.")?this.stopNodesWildcard.add(r.substring(2)):this.stopNodesExact.add(r))}}}}function Tr(n){const t=Object.keys(n);for(let e=0;e<t.length;e++){const r=t[e];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:n[r]}}}function Sr(n,t,e,r,s,i,o){if(n!==void 0&&(this.options.trimValues&&!r&&(n=n.trim()),n.length>0)){o||(n=this.replaceEntitiesValue(n));const d=this.options.tagValueProcessor(t,n,e,s,i);return d==null?n:typeof d!=typeof n||d!==n?d:this.options.trimValues?ct(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?ct(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function kr(n){if(this.options.removeNSPrefix){const t=n.split(":"),e=n.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(n=e+t[1])}return n}const xr=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Fr(n,t,e){if(this.options.ignoreAttributes!==!0&&typeof n=="string"){const r=Pt(n,xr),s=r.length,i={};for(let o=0;o<s;o++){const d=this.resolveNameSpace(r[o][1]);if(this.ignoreAttributesFn(d,t))continue;let l=r[o][4],u=this.options.attributeNamePrefix+d;if(d.length)if(this.options.transformAttributeName&&(u=this.options.transformAttributeName(u)),u==="__proto__"&&(u="#__proto__"),l!==void 0){this.options.trimValues&&(l=l.trim()),l=this.replaceEntitiesValue(l);const E=this.options.attributeValueProcessor(d,l,t);E==null?i[u]=l:typeof E!=typeof l||E!==l?i[u]=E:i[u]=ct(l,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[u]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=i,o}return i}}const Cr=function(n){n=n.replace(/\r\n?/g,`
`);const t=new ze("!xml");let e=t,r="",s="";const i=new gr(this.options.processEntities);for(let o=0;o<n.length;o++)if(n[o]==="<")if(n[o+1]==="/"){const l=Ve(n,">",o,"Closing Tag is not closed.");let u=n.substring(o+2,l).trim();if(this.options.removeNSPrefix){const R=u.indexOf(":");R!==-1&&(u=u.substr(R+1))}this.options.transformTagName&&(u=this.options.transformTagName(u)),e&&(r=this.saveTextToParentTag(r,e,s));const E=s.substring(s.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`);let _=0;E&&this.options.unpairedTags.indexOf(E)!==-1?(_=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):_=s.lastIndexOf("."),s=s.substring(0,_),e=this.tagsNodeStack.pop(),r="",o=l}else if(n[o+1]==="?"){let l=dt(n,o,!1,"?>");if(!l)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,e,s),!(this.options.ignoreDeclaration&&l.tagName==="?xml"||this.options.ignorePiTags)){const u=new ze(l.tagName);u.add(this.options.textNodeName,""),l.tagName!==l.tagExp&&l.attrExpPresent&&(u[":@"]=this.buildAttributesMap(l.tagExp,s,l.tagName)),this.addChild(e,u,s,o)}o=l.closeIndex+1}else if(n.substr(o+1,3)==="!--"){const l=Ve(n,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){const u=n.substring(o+4,l-2);r=this.saveTextToParentTag(r,e,s),e.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}o=l}else if(n.substr(o+1,2)==="!D"){const l=i.readDocType(n,o);this.docTypeEntities=l.entities,o=l.i}else if(n.substr(o+1,2)==="!["){const l=Ve(n,"]]>",o,"CDATA is not closed.")-2,u=n.substring(o+9,l);r=this.saveTextToParentTag(r,e,s);let E=this.parseTextData(u,e.tagname,s,!0,!1,!0,!0);E==null&&(E=""),this.options.cdataPropName?e.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}]):e.add(this.options.textNodeName,E),o=l+2}else{let l=dt(n,o,this.options.removeNSPrefix),u=l.tagName;const E=l.rawTagName;let _=l.tagExp,R=l.attrExpPresent,B=l.closeIndex;this.options.transformTagName&&(u=this.options.transformTagName(u)),e&&r&&e.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,e,s,!1));const G=e;G&&this.options.unpairedTags.indexOf(G.tagname)!==-1&&(e=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),u!==t.tagname&&(s+=s?"."+u:u);const k=o;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,s,u)){let y="";if(_.length>0&&_.lastIndexOf("/")===_.length-1)u[u.length-1]==="/"?(u=u.substr(0,u.length-1),s=s.substr(0,s.length-1),_=u):_=_.substr(0,_.length-1),o=l.closeIndex;else if(this.options.unpairedTags.indexOf(u)!==-1)o=l.closeIndex;else{const C=this.readStopNodeData(n,E,B+1);if(!C)throw new Error(`Unexpected end of ${E}`);o=C.i,y=C.tagContent}const z=new ze(u);u!==_&&R&&(z[":@"]=this.buildAttributesMap(_,s,u)),y&&(y=this.parseTextData(y,u,s,!0,R,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),z.add(this.options.textNodeName,y),this.addChild(e,z,s,k)}else{if(_.length>0&&_.lastIndexOf("/")===_.length-1){u[u.length-1]==="/"?(u=u.substr(0,u.length-1),s=s.substr(0,s.length-1),_=u):_=_.substr(0,_.length-1),this.options.transformTagName&&(u=this.options.transformTagName(u));const y=new ze(u);u!==_&&R&&(y[":@"]=this.buildAttributesMap(_,s,u)),this.addChild(e,y,s,k),s=s.substr(0,s.lastIndexOf("."))}else{const y=new ze(u);this.tagsNodeStack.push(e),u!==_&&R&&(y[":@"]=this.buildAttributesMap(_,s,u)),this.addChild(e,y,s,k),e=y}r="",o=B}}else r+=n[o];return t.child};function Ar(n,t,e,r){this.options.captureMetaData||(r=void 0);const s=this.options.updateTag(t.tagname,e,t[":@"]);s===!1||(typeof s=="string"&&(t.tagname=s),n.addChild(t,r))}const Pr=function(n){if(this.options.processEntities){for(let t in this.docTypeEntities){const e=this.docTypeEntities[t];n=n.replace(e.regx,e.val)}for(let t in this.lastEntities){const e=this.lastEntities[t];n=n.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const e=this.htmlEntities[t];n=n.replace(e.regex,e.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function Rr(n,t,e,r){return n&&(r===void 0&&(r=t.child.length===0),n=this.parseTextData(n,t.tagname,e,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,r),n!==void 0&&n!==""&&t.add(this.options.textNodeName,n),n=""),n}function zr(n,t,e,r){return!!(t&&t.has(r)||n&&n.has(e))}function Or(n,t,e=">"){let r,s="";for(let i=t;i<n.length;i++){let o=n[i];if(r)o===r&&(r="");else if(o==='"'||o==="'")r=o;else if(o===e[0])if(e[1]){if(n[i+1]===e[1])return{data:s,index:i}}else return{data:s,index:i};else o==="	"&&(o=" ");s+=o}}function Ve(n,t,e,r){const s=n.indexOf(t,e);if(s===-1)throw new Error(r);return s+t.length-1}function dt(n,t,e,r=">"){const s=Or(n,t+1,r);if(!s)return;let i=s.data;const o=s.index,d=i.search(/\s/);let l=i,u=!0;d!==-1&&(l=i.substring(0,d),i=i.substring(d+1).trimStart());const E=l;if(e){const _=l.indexOf(":");_!==-1&&(l=l.substr(_+1),u=l!==s.data.substr(_+1))}return{tagName:l,tagExp:i,closeIndex:o,attrExpPresent:u,rawTagName:E}}function jr(n,t,e){const r=e;let s=1;for(;e<n.length;e++)if(n[e]==="<")if(n[e+1]==="/"){const i=Ve(n,">",e,`${t} is not closed`);if(n.substring(e+2,i).trim()===t&&(s--,s===0))return{tagContent:n.substring(r,e),i};e=i}else if(n[e+1]==="?")e=Ve(n,"?>",e+1,"StopNode is not closed.");else if(n.substr(e+1,3)==="!--")e=Ve(n,"-->",e+3,"StopNode is not closed.");else if(n.substr(e+1,2)==="![")e=Ve(n,"]]>",e,"StopNode is not closed.")-2;else{const i=dt(n,e,">");i&&((i&&i.tagName)===t&&i.tagExp[i.tagExp.length-1]!=="/"&&s++,e=i.closeIndex)}}function ct(n,t,e){if(t&&typeof n=="string"){const r=n.trim();return r==="true"?!0:r==="false"?!1:br(n,e)}else return tr(n)?n:""}const ot=ze.getMetaDataSymbol();function Vr(n,t){return Rt(n,t)}function Rt(n,t,e){let r;const s={};for(let i=0;i<n.length;i++){const o=n[i],d=Gr(o);let l="";if(e===void 0?l=d:l=e+"."+d,d===t.textNodeName)r===void 0?r=o[d]:r+=""+o[d];else{if(d===void 0)continue;if(o[d]){let u=Rt(o[d],t,l);const E=Mr(u,t);o[ot]!==void 0&&(u[ot]=o[ot]),o[":@"]?Lr(u,o[":@"],l,t):Object.keys(u).length===1&&u[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?u=u[t.textNodeName]:Object.keys(u).length===0&&(t.alwaysCreateTextNode?u[t.textNodeName]="":u=""),s[d]!==void 0&&s.hasOwnProperty(d)?(Array.isArray(s[d])||(s[d]=[s[d]]),s[d].push(u)):t.isArray(d,l,E)?s[d]=[u]:s[d]=u}}}return typeof r=="string"?r.length>0&&(s[t.textNodeName]=r):r!==void 0&&(s[t.textNodeName]=r),s}function Gr(n){const t=Object.keys(n);for(let e=0;e<t.length;e++){const r=t[e];if(r!==":@")return r}}function Lr(n,t,e,r){if(t){const s=Object.keys(t),i=s.length;for(let o=0;o<i;o++){const d=s[o];r.isArray(d,e+"."+d,!0,!0)?n[d]=[t[d]]:n[d]=t[d]}}}function Mr(n,t){const{textNodeName:e}=t,r=Object.keys(n).length;return!!(r===0||r===1&&(n[e]||typeof n[e]=="boolean"||n[e]===0))}class Ur{constructor(t){this.externalEntities={},this.options=fr(t)}parse(t,e){if(typeof t!="string"&&t.toString)t=t.toString();else if(typeof t!="string")throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const i=rr(t,e);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const r=new Nr(this.options);r.addExternalEntities(this.externalEntities);const s=r.parseXml(t);return this.options.preserveOrder||s===void 0?s:Vr(s,this.options)}addEntity(t,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}static getMetaDataSymbol(){return ze.getMetaDataSymbol()}}var Br=O('<p class="uno-gv1863">Searching...</p>'),qr=O('<button class="uno-g4tfb0"><div class="uno-4p27ks"><p class="uno-2h7i51"> </p> <p class="uno-w3tle4"> </p></div> <div class="uno-3y4nf5" aria-label="Add group" title="Add group"></div></button>'),Hr=O('<div class="uno-tx6af9"><form class="uno-yiav9y"><div class="uno-n9hnzz"><label for="search-query-input" class="uno-8z898c">Search for a group:</label> <input class="uno-ef6tqv" id="search-query-input" type="text" placeholder="Search for a group"/></div> <button class="uno-kow0um" type="submit">Search</button></form> <div class="uno-3n84nq"><!></div></div>');function Yr(n,t){de(t,!0);const e=qe(He);if(!e)throw new Error("TargetingGroupSearch must be used within a component that provides TargetingState context");let r=V(""),s=V(ye([])),i=V(!1);async function o(){if(!(!a(r).trim()||a(r).trim().length<=2||a(i))){N(i,!0);try{const y=await Yt(a(r).trim());N(s,y.data??[],!0)}catch(y){console.error(y)}finally{N(i,!1)}}}function d(y,z){if(e.availableScanGroups.find(M=>M.groupId===y))return;const C=new kt;C.groupId=y,C.groupName=z,e.availableScanGroups=[...e.availableScanGroups,C],N(s,[],!0),N(r,"")}var l=Hr(),u=f(l),E=f(u),_=p(f(E),2);oe(_),c(E),ve(2),c(u);var R=p(u,2),B=f(R);{var G=y=>{var z=Br();P(y,z)},k=y=>{var z=Oe(),C=Ce(z);ke(C,17,()=>a(s),xe,(M,q)=>{var U=qr();U.__click=()=>d(a(q).id,a(q).name);var w=f(U),b=f(w),v=f(b,!0);c(b);var m=p(b,2),g=f(m,!0);c(m),c(w),ve(2),c(U),Q(()=>{J(v,a(q).id),J(g,a(q).name)}),P(M,U)}),P(y,z)};K(B,y=>{a(i)?y(G):y(k,!1)})}c(R),c(l),Re("submit",u,y=>{y.preventDefault(),o()}),Se(_,()=>a(r),y=>N(r,y)),P(n,l),ce()}be(["click"]);var Kr=O('<div class="uno-dxjz78"><div class="uno-dxjz78"><h2 class="uno-2hnkag">Targeting Preparation (Required)</h2> <!> <!> <!></div> <div class="uno-dxjz78"><h2 class="uno-2hnkag">Group Preparation</h2> <!> <!></div> <div class="uno-dxjz78"><div class="uno-dxjz78"><h2 class="uno-87jryj">Batch Edit</h2> <!></div> <button type="button" class="uno-6s7sce">Start Upload</button> <div class="uno-dxjz78"><div class="uno-rp89gc"><h2 class="uno-87jryj">Chapters</h2> <label class="uno-dsxd6g"><input type="checkbox" class="uno-gtaeaa"/> <span class="uno-i5d3fz">Show only chapters without groups</span></label> <label class="uno-dsxd6g"><input type="checkbox" class="uno-gtaeaa"/> <span class="uno-i5d3fz">Show only non-deleted chapters</span></label></div> <div class="uno-ovwqmg"></div></div></div></div>');function Wr(n,t){de(t,!0);const e=qe(He);if(!e)throw new Error("TargetingPreparation must be used within a component that provides TargetingState context");let r=me(()=>e.seriesId),s=V(!1),i=V(!0),o=me(()=>{if(!a(s)&&!a(i))return e.chapterStates;let I=e.chapterStates;return a(s)&&(I=I.filter(T=>!T.associatedGroup.groupIds||T.associatedGroup.groupIds.length===0)),a(i)&&(I=I.filter(T=>!T.isDeleted)),I});async function d(I,T,F){let h=null,j=null,H=null;if(I.file.name.toLowerCase()==="comicinfo.xml")try{const W=await I.file.text(),le=new Ur({ignoreAttributes:!1,attributeNamePrefix:"@_",parseAttributeValue:!0,trimValues:!0}).parse(W);if(le.ComicInfo){const ne=le.ComicInfo;ne.Title&&(h=ne.Title),ne.Number!==void 0&&ne.Number!==null&&(j=String(ne.Number)),ne.Volume!==void 0&&ne.Volume!==null&&(H=String(ne.Volume))}}catch(W){console.error("Failed to parse ComicInfo.xml:",W)}const Z=T.map((W,$)=>{const le=W.type===Ue.CHAPTER_PAGE;return new bt(W.file.name,$,W.file,_t.NOT_STARTED,0,null,null,!le,W.type)});return new yt(F,h??"",H,j,new at,new lt,Z,Et.NOT_STARTED,0,null,null,new ut(F,F,[I,...T],[],0,0),!1,"en")}Ie(()=>{(async()=>{const I=await Promise.all(t.selectedFolders.map(async(T,F)=>{const h=T.files.filter(H=>H.type===Ue.CHAPTER_DEFINITION_FILE);if(h.length===1){const H=T.files.filter(Y=>Y.type!==Ue.CHAPTER_DEFINITION_FILE);return await d(h[0],H,T.path)}const j=T.files.map((H,Y)=>{const Z=H.type===Ue.CHAPTER_PAGE;return new bt(H.file.name,Y,H.file,_t.NOT_STARTED,0,null,null,!Z,H.type)});return new yt(T.path,T.name,null,F.toString(),new at,new lt,j,Et.NOT_STARTED,0,null,null,null,!1,"en")}));e.chapterStates=I})()});function l(I){return[...I].sort((T,F)=>{const h=T.chapterVolume,j=F.chapterVolume;if(!(h===null&&j===null)){if(h===null)return 1;if(j===null)return-1;{const Z=String(h).localeCompare(String(j),void 0,{numeric:!0,sensitivity:"base"});if(Z!==0)return Z}}const H=T.chapterNumber,Y=F.chapterNumber;return H===null&&Y===null?0:H===null?1:Y===null?-1:String(H).localeCompare(String(Y),void 0,{numeric:!0,sensitivity:"base"})})}Ie(()=>{const I=l(e.chapterStates);for(let T=0;T<I.length;T++)if(I[T].originalFolderPath!==e.chapterStates[T].originalFolderPath){e.chapterStates=I;return}}),Ie(()=>{e.seriesId!==null&&e.chapterStates.forEach(I=>{I.associatedSeries||(I.associatedSeries=new at),I.associatedSeries.seriesId=e.seriesId??""})});var u=Kr(),E=f(u),_=p(f(E),2);Kt(_,{});var R=p(_,2);Wt(R,{});var B=p(R,2);Zt(B,{}),c(E);var G=p(E,2),k=p(f(G),2);vn(k,{});var y=p(k,2);Yr(y,{}),c(G);var z=p(G,2),C=f(z),M=p(f(C),2);Qn(M,{get chapters(){return e.chapterStates},set chapters(I){e.chapterStates=I}}),c(C);var q=p(C,2);q.__click=function(...I){t.onDone?.apply(this,I)};var U=p(q,2),w=f(U),b=p(f(w),2),v=f(b);oe(v),ve(2),c(b);var m=p(b,2),g=f(m);oe(g),ve(2),c(m),c(w);var x=p(w,2);ke(x,21,()=>a(o),xe,(I,T,F)=>{const h=me(()=>e.chapterStates.findIndex(j=>j===a(T)));Zn(I,{index:F,get chapter(){return e.chapterStates[a(h)]},set chapter(j){e.chapterStates[a(h)]=j}})}),c(x),c(U),c(z),c(u),Q(()=>q.disabled=!a(r)),Ge(v,()=>a(s),I=>N(s,I)),Ge(g,()=>a(i),I=>N(i,I)),P(n,u),ce()}be(["click"]);var Zr=O('<span class="uno-57st91"></span>'),Xr=O('<span class="uno-wekq8j"></span>'),Jr=O('<span class="uno-vl9lsr"><!></span>'),Qr=O('<span class="uno-ysln7w"></span>'),$r=O('<div class="uno-7tlu5e"><span class="uno-ysln7w"></span> <span class="uno-w0z7mh"></span> <span class="uno-01bs70"> </span> <span class="uno-n4cnqc"> </span></div>'),Dr=O('<div class="uno-pkltwb"><!> <!></div>'),es=O('<div><button type="button" class="uno-63wdec"><!> <span class="uno-r67jyj"></span> <span class="uno-cfa50z"> </span> <span class="uno-2as1mj"> </span> <span class="uno-bwfsan"> </span></button> <!></div>');function zt(n,t){de(t,!0);let e=se(t,"level",3,0),r=se(t,"class",3,""),s=V(!1);function i(){o&&N(s,!a(s))}const o=t.folder.files.length>0||t.folder.folders.length>0,d=`${e()*5}px`;var l=es(),u=f(l);u.__click=i;var E=f(u);{var _=U=>{var w=Jr(),b=f(w);{var v=g=>{var x=Zr();P(g,x)},m=g=>{var x=Xr();P(g,x)};K(b,g=>{a(s)?g(v):g(m,!1)})}c(w),P(U,w)},R=U=>{var w=Qr();P(U,w)};K(E,U=>{o?U(_):U(R,!1)})}var B=p(E,4),G=f(B,!0);c(B);var k=p(B,2),y=f(k);c(k);var z=p(k,2),C=f(z);c(z),c(u);var M=p(u,2);{var q=U=>{var w=Dr(),b=f(w);ke(b,17,()=>t.folder.folders,xe,(m,g)=>{{let x=me(()=>e()+1);zt(m,{get folder(){return a(g)},get level(){return a(x)}})}});var v=p(b,2);ke(v,17,()=>t.folder.files,xe,(m,g)=>{var x=$r(),I=p(f(x),4),T=f(I,!0);c(I);var F=p(I,2),h=f(F);c(F),c(x),Q(j=>{Be(x,`padding-left: ${d};`),J(T,a(g).file.name),J(h,`${j??""} KB`)},[()=>(a(g).file.size/1024).toFixed(2)]),P(m,x)}),c(w),Q(()=>Be(w,`margin-left: ${d};`)),P(U,w)};K(M,U=>{a(s)&&U(q)})}c(l),Q(()=>{he(l,1,Ne(["uno-0q6x3s",r()])),Be(u,`padding-left: ${d};`),u.disabled=!o,J(G,t.folder.name||"Root"),J(y,`L${t.folder.level??""}`),J(C,`(${t.folder.files.length??""} file${t.folder.files.length!==1?"s":""}, ${t.folder.folders.length??""} folder${t.folder.folders.length!==1?"s":""})`)}),P(n,l),ce()}be(["click"]);var ts=O(`<div><h2 class="uno-tuwa1l text-md"> </h2> <div class="uno-dby05x"><div class="uno-41oacz"><div><h3 class="uno-66ploz">Chapter Name Level</h3> <p class="uno-5ik2j2">This is the level at which folders will be grouped into chapters (the L numbering on the
					directory explorer). The folders at this level will be used to group together chapters.</p></div> <!></div> <div class="uno-41oacz"><div><h3 class="uno-66ploz">File Level</h3> <p class="uno-5ik2j2">This is the level at which files inside folders will be considered as being a part of the
					chapter (the L numbering on the directory explorer). Only files contained within folders
					at this level will be considered as being a part of the chapter.</p></div> <!></div></div> <div class="uno-41oacz"><div><h3 class="uno-66ploz">File Path Filter</h3> <p class="uno-5ik2j2">This is a regex filter that will be applied in addition to the file level selector. This is
				useful if you have multiple files at the same file level, but are only really interested in
				a subset of them.</p></div> <div class="uno-tf0zt3"><button type="button" class="uno-786krg">Set Example Exclusion Regex</button> <button type="button" class="uno-786krg">Set Example Inclusion Regex</button> <div class="uno-ahr0cj"><input type="checkbox" class="uno-mzfs6x"/> <label for="isRegexCaseSensitive" class="uno-5ik2j2">Case Sensitive</label></div></div> <input type="text" placeholder="Filter files by path regex..." class="uno-fzo9yc"/></div></div>`);function ns(n,t){de(t,!0);let e=se(t,"class",3,""),r=se(t,"slicedFolders",15,null),s=me(()=>t.selectedFolder.depth),i=V("1"),o=V("1"),d=V(""),l=V(!1);Ie(()=>{a(i)&&a(o)&&parseInt(a(o))<parseInt(a(i))&&N(o,a(i),!0);const T=u(parseInt(a(i)),t.selectedFolder),F=_(T,a(d));F.sort((h,j)=>h.name.localeCompare(j.name)),r(F)});function u(T,F){let h=[];for(const j of F.folders){if(j.level===T){h.push(j);continue}j.level<T&&h.push(...u(T,j))}return h}function E(T){const F=T.files;let h=[];for(const j of T.folders)h.push(...E(j));return[...F,...h]}function _(T,F){let h=[];const j=F.trim();if(j===""){for(const Y of T){const Z=E(Y);Z.length!==0&&h.push(new ut(Y.name,Y.path,Z,[],Y.level,0))}return h}const H=new RegExp(j,a(l)?"g":"gi");for(const Y of T){const ie=E(Y).filter(W=>H.test(W.path));ie.length!==0&&h.push(new ut(Y.name,Y.path,ie,[],Y.level,0))}return h}function R(){N(d,"^(?!.*filename).*$")}function B(){N(d,"filename")}var G=ts(),k=f(G),y=f(k);c(k);var z=p(k,2),C=f(z),M=p(f(C),2);{let T=me(()=>Array.from({length:a(s)},(F,h)=>h+1).map(F=>F.toString()));Qe(M,{get items(){return a(T)},class:"uno-p2tdxo",get selectedItem(){return a(i)},set selectedItem(F){N(i,F,!0)}})}c(C);var q=p(C,2),U=p(f(q),2);{let T=me(()=>Array.from({length:a(s)},(F,h)=>h+1).map(F=>F.toString()));Qe(U,{get items(){return a(T)},class:"uno-p2tdxo",get selectedItem(){return a(o)},set selectedItem(F){N(o,F,!0)}})}c(q),c(z);var w=p(z,2),b=p(f(w),2),v=f(b);v.__click=R;var m=p(v,2);m.__click=B;var g=p(m,2),x=f(g);oe(x),ve(2),c(g),c(b);var I=p(b,2);oe(I),c(w),c(G),Q(()=>{he(G,1,Ne(["uno-p7gj2t",e()])),J(y,`Vertical Slice Pane - ${a(s)??""}`)}),Ge(x,()=>a(l),T=>N(l,T)),Se(I,()=>a(d),T=>N(d,T)),P(n,G),ce()}be(["click"]);var rs=O('<button class="uno-ib5962"><div class="uno-xqpedf"><p class="uno-9fhwl6"><span class="uno-kgt3zb">Path:</span> </p> <div class="uno-rgzzux"><p class="uno-9fhwl6"><span class="uno-kgt3zb">Name:</span> </p> <p class="uno-9fhwl6"><span class="uno-kgt3zb">Files:</span> </p></div></div> <input type="checkbox" class="uno-drnypz"/></button>');function ss(n,t){de(t,!0);let e=se(t,"selectedSlicedFolder",15,null);function r(){e(e().isSelected=!e().isSelected,!0)}var s=rs();s.__click=r;var i=f(s),o=f(i),d=p(f(o));c(o);var l=p(o,2),u=f(l),E=p(f(u));c(u);var _=p(u,2),R=p(f(_));c(_),c(l),c(i);var B=p(i,2);oe(B),c(s),Q(()=>{J(d,` ${e().folder.path??""}`),J(E,` ${e().folder.name??""}`),J(R,` ${e().folder.files.length??""}`)}),Ge(B,()=>e().isSelected,G=>e(e().isSelected=G,!0)),P(n,s),ce()}be(["click"]);var is=O("<div></div>");function as(n,t){de(t,!0);let e=se(t,"class",3,""),r=se(t,"selectedSlicedFolders",31,()=>ye([]));Ie(()=>{r(t.slicedFolders.map(i=>({folder:i,isSelected:!0})))});var s=is();ke(s,21,r,xe,(i,o,d)=>{ss(i,{get selectedSlicedFolder(){return r()[d]},set selectedSlicedFolder(l){r(r()[d]=l,!0)}})}),c(s),Q(()=>he(s,1,Ne(["uno-c09693",e()]))),P(n,s),ce()}var os=O('<div><h2 class="uno-big2dz text-md"> </h2> <!></div> <button type="button" class="uno-4mp1rf">Continue to Editor</button>',1),ls=O('<div><h1 class="uno-5gcp3l">Vertical Slicer</h1> <div class="uno-0l5rnf"><div><h2 class="uno-u2fo5v text-md">Directory Explorer</h2></div> <div class="uno-uwenez"></div> <div class="uno-7k8lj1"><h2 class="uno-big2dz text-md">Slicer</h2></div></div> <div class="uno-0402h6"><div class="uno-z8ysy7"><!></div> <button type="button" class="uno-1es7ju group" aria-label="Resize panels"><div class="uno-gtkyu2"><div class="uno-amtufd"></div> <div class="uno-amtufd"></div> <div class="uno-amtufd"></div></div></button> <div class="uno-w96zyv"><!></div></div> <!></div>');function us(n,t){de(t,!0);let e=se(t,"finalizedFolderSelection",15,null),r=se(t,"class",3,""),s=V(null),i=V(ye([])),o=me(()=>a(i).filter(g=>g.isSelected)),d=me(()=>Xt(t.selectedFiles??[])),l=V(null),u=V(!1),E=V(20);function _(){e(a(o).map(g=>g.folder)),t.onDone()}function R(g){N(u,!0)}function B(g){if(!a(u)||!a(l))return;const x=a(l).getBoundingClientRect(),I=(g.clientX-x.left)/x.width*100;N(E,Math.max(20,Math.min(80,I)),!0)}function G(){N(u,!1)}Ie(()=>{if(a(u))return document.addEventListener("mousemove",B),document.addEventListener("mouseup",G),document.body.style.cursor="col-resize",document.body.style.userSelect="none",()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",G),document.body.style.cursor="",document.body.style.userSelect=""}});var k=ls(),y=p(f(k),2),z=f(y);ve(4),c(y);var C=p(y,2),M=f(C),q=f(M);zt(q,{get folder(){return a(d)}}),c(M);var U=p(M,2);U.__mousedown=R;var w=p(U,2),b=f(w);ns(b,{get selectedFolder(){return a(d)},get slicedFolders(){return a(s)},set slicedFolders(g){N(s,g,!0)}}),c(w),c(C),Ze(C,g=>N(l,g),()=>a(l));var v=p(C,2);{var m=g=>{var x=os(),I=Ce(x),T=f(I),F=f(T);c(T);var h=p(T,2);as(h,{get slicedFolders(){return a(s)},class:"uno-xmletc",get selectedSlicedFolders(){return a(i)},set selectedSlicedFolders(H){N(i,H,!0)}}),c(I);var j=p(I,2);j.__click=_,Q(()=>{J(F,`Vertical Slice Preview (${a(o).length??""}
				selected)`),j.disabled=a(o).length===0}),P(g,x)};K(v,g=>{a(s)&&g(m)})}c(k),Q(()=>{he(k,1,`uno-xxsekz ${r()??""}`),Be(z,`width: ${a(E)??""}%;`),Be(M,`width: ${a(E)??""}%;`)}),P(n,k),ce()}be(["mousedown","click"]);var ds=O("<p>todo: finished</p>"),cs=O('<div class="uno-r204ub"><div class="uno-kd0tpq"><h1 class="uno-oq6hfo">Uploader Improved</h1> <div class="uno-b6vj60"><button type="button" class="uno-affps4">Guided Mode</button> <!></div></div> <a target="_blank" class="uno-io1u0r">Tutorial & Docs</a> <!> <div class="uno-l3b4kf"><button type="button">Pick Folder</button> <div class="uno-57hmfs"></div> <button type="button">Select Folders</button> <div class="uno-57hmfs"></div> <button type="button">Edit Chapters</button> <div class="uno-57hmfs"></div> <button type="button">Upload</button> <div class="uno-57hmfs"></div> <button type="button">Finished</button></div> <!></div>');function Is(n,t){de(t,!0);let e=V(null),r=V(null);mt(xt,new en),mt(He,new Qt);var s=(h=>(h.PICKING_FOLDER="PICKING_FOLDER",h.SELECTING_FOLDERS="SELECTING_FOLDERS",h.EDITING_CHAPTERS="EDITING_CHAPTERS",h.UPLOADING="UPLOADING",h.FINISHED="FINISHED",h))(s||{});let i=V(!1),o=V("PICKING_FOLDER"),d=me(()=>a(o)==="UPLOADING"&&a(i)),l=me(()=>a(o)!=="UPLOADING"&&a(o)!=="EDITING_CHAPTERS");function u(h){a(e)&&N(o,h,!0)}function E(){N(o,"SELECTING_FOLDERS")}function _(){N(o,"EDITING_CHAPTERS")}function R(){N(o,"UPLOADING")}function B(){N(o,"FINISHED")}var G=cs(),k=f(G),y=p(f(k),2),z=f(y);z.__click=()=>tn(wt("/guided"));var C=p(z,2);Jt(C,{}),c(y),c(k);var M=p(k,2),q=p(M,2);{var U=h=>{$t(h,{})};K(q,h=>{a(l)&&h(U)})}var w=p(q,2),b=f(w);b.__click=()=>u(s.PICKING_FOLDER);var v=p(b,4);v.__click=()=>u(s.SELECTING_FOLDERS);var m=p(v,4);m.__click=()=>u(s.EDITING_CHAPTERS);var g=p(m,4);g.__click=()=>u(s.UPLOADING);var x=p(g,4);x.disabled=!0,c(w);var I=p(w,2);{var T=h=>{un(h,{onDone:E,class:"uno-r3xq7g",get selectedFiles(){return a(e)},set selectedFiles(j){N(e,j,!0)}})},F=h=>{var j=Oe(),H=Ce(j);{var Y=ie=>{us(ie,{onDone:_,get selectedFiles(){return a(e)},get finalizedFolderSelection(){return a(r)},set finalizedFolderSelection(W){N(r,W,!0)}})},Z=ie=>{var W=Oe(),$=Ce(W);{var le=ue=>{Wr(ue,{get selectedFolders(){return a(r)},onDone:R})},ne=ue=>{var Ee=Oe(),Le=Ce(Ee);{var Ye=we=>{Dt(we,{onDone:B,get busy(){return a(i)},set busy(Te){N(i,Te,!0)}})},Fe=we=>{var Te=Oe(),A=Ce(Te);{var L=ee=>{var Ae=ds();P(ee,Ae)};K(A,ee=>{a(o)===s.FINISHED&&ee(L)},!0)}P(we,Te)};K(Le,we=>{a(o)===s.UPLOADING?we(Ye):we(Fe,!1)},!0)}P(ue,Ee)};K($,ue=>{a(o)===s.EDITING_CHAPTERS&&a(r)?ue(le):ue(ne,!1)},!0)}P(ie,W)};K(H,ie=>{a(o)===s.SELECTING_FOLDERS?ie(Y):ie(Z,!1)},!0)}P(h,j)};K(I,h=>{a(o)===s.PICKING_FOLDER?h(T):h(F,!1)})}c(G),Q(h=>{je(M,"href",h),he(b,1,Ne({"uno-mpkkic":!0,"uno-ywbfsm":a(o)!==s.PICKING_FOLDER,"uno-djdziu":a(o)===s.PICKING_FOLDER})),b.disabled=a(d),he(v,1,Ne({"uno-mpkkic":!0,"uno-ywbfsm":a(o)!==s.SELECTING_FOLDERS,"uno-djdziu":a(o)===s.SELECTING_FOLDERS})),v.disabled=!a(e)||a(d),he(m,1,Ne({"uno-mpkkic":!0,"uno-ywbfsm":a(o)!==s.EDITING_CHAPTERS,"uno-djdziu":a(o)===s.EDITING_CHAPTERS})),m.disabled=!a(r)||a(d),he(g,1,Ne({"uno-mpkkic":!0,"uno-ywbfsm":a(o)!==s.UPLOADING,"uno-djdziu":a(o)===s.UPLOADING})),g.disabled=!a(r)||a(d),he(x,1,Ne({"uno-mpkkic":!0,"uno-ywbfsm":a(o)!==s.FINISHED,"uno-djdziu":a(o)===s.FINISHED}))},[()=>wt("/docs")]),P(n,G),ce()}be(["click"]);export{Is as component,ws as universal};
