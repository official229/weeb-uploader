import{f as w,a as h,c as Me}from"../chunks/CdXyPVf1.js";import{z as Et,A as T,B as e,C as c,D as ze,E as Ke,I as r,K as l,J as a,G as W,H as Xe,aH as be,aI as Ft,aJ as ut,u as Re,F as De,aC as lt,af as Rt}from"../chunks/CIcfCS9e.js";import{d as $e}from"../chunks/CMrQpYvR.js";import{p as Te,b as at,i as D}from"../chunks/Bp05Fg2P.js";import{r as Pt,a as Gt,s as gt}from"../chunks/DVberjZs.js";import{s as x}from"../chunks/BR9ubxrB.js";import{S as vt,s as Ee,e as Ue,i as We,D as Dt,c as Tt,g as Ct,a as Zt,t as wt,T as Lt,b as Ot,d as kt,C as He,p as zt,f as Mt,h as Ut,j as Wt,k as jt,l as Yt,m as Vt,n as qt,o as mt,q as Bt,r as pt,u as Ht,v as Kt,w as Xt,Z as $t,B as Jt,x as Qt,y as es,z as ts,U as ss,A as is,E as as}from"../chunks/DivKOe_k.js";import{b as It,A as rs}from"../chunks/LF6JFb3L.js";import{a as ns,r as _t}from"../chunks/DliSDB4U.js";import{g as os}from"../chunks/CU1gEIhW.js";const ls=!0,yi=Object.freeze(Object.defineProperty({__proto__:null,prerender:ls},Symbol.toStringTag,{value:"Module"}));var ke=(E=>(E.SELECTING_ROOT_FOLDER="SELECTING_ROOT_FOLDER",E.SELECTING_MANGA_FOLDERS="SELECTING_MANGA_FOLDERS",E.PROCESSING_MANGA="PROCESSING_MANGA",E))(ke||{}),oe=(E=>(E.PENDING="PENDING",E.PROCESSING="PROCESSING",E.COMPLETED="COMPLETED",E.ERROR="ERROR",E.WARNING="WARNING",E))(oe||{}),_=(E=>(E.LOADING="LOADING",E.EXTRACTING="EXTRACTING",E.SERIES_LOOKUP="SERIES_LOOKUP",E.APPLYING_REGEX="APPLYING_REGEX",E.CHAPTER_LOOKUP="CHAPTER_LOOKUP",E.LOADING_GROUPS="LOADING_GROUPS",E.APPLYING_GROUPS="APPLYING_GROUPS",E.APPLYING_TITLES="APPLYING_TITLES",E.READY="READY",E.READY_WARNING="READY_WARNING",E.UPLOADING="UPLOADING",E.COMPLETED="COMPLETED",E))(_||{});class us{#e=T(null);get rootFolderFiles(){return e(this.#e)}set rootFolderFiles(t){c(this.#e,t,!0)}#t=T(ze([]));get zipFiles(){return e(this.#t)}set zipFiles(t){c(this.#t,t,!0)}#s=T(ze([]));get selectedZipFiles(){return e(this.#s)}set selectedZipFiles(t){c(this.#s,t,!0)}#i=T(-1);get currentZipIndex(){return e(this.#i)}set currentZipIndex(t){c(this.#i,t,!0)}#a=T("SELECTING_ROOT_FOLDER");get workflowStep(){return e(this.#a)}set workflowStep(t){c(this.#a,t,!0)}get currentZip(){return this.currentZipIndex<0||this.currentZipIndex>=this.zipFiles.length?null:this.zipFiles[this.currentZipIndex]}get unprocessedZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status!=="COMPLETED")}get pendingZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="PENDING")}get warningZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="WARNING")}get errorZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="ERROR")}get completedZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="COMPLETED")}get processingZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="PROCESSING")}get nextZip(){const t=this.pendingZips;if(t.length===0)return null;const i=this.currentZip,s=i?t.filter(b=>b.file!==i.file):t;return s.length===0?null:s[0]}setZipStatus(t,i){const s=this.zipFiles.find(b=>b.file===t);s&&(s.status=i)}moveToNextZip(){const t=this.nextZip;if(!t)return!1;const i=this.zipFiles.findIndex(s=>s.file===t.file);return i>=0?(this.currentZipIndex=i,!0):!1}get zipFilesByMangaFolder(){const t=new vt;for(const i of this.zipFiles)t.has(i.mangaFolderName)||t.set(i.mangaFolderName,[]),t.get(i.mangaFolderName).push(i);return t}reset(){this.rootFolderFiles=null,this.zipFiles=[],this.selectedZipFiles=[],this.currentZipIndex=-1,this.workflowStep="SELECTING_ROOT_FOLDER"}}class cs{#e=T(!1);get enabled(){return e(this.#e)}set enabled(t){c(this.#e,t,!0)}get isActive(){return this.enabled}enable(){this.enabled=!0}disable(){this.enabled=!1}reset(){this.enabled=!1}}const ds=Et(),ft=Et();var ps=w('<div class="uno-4maolu"><div class="uno-senp7v"></div> <p class="uno-l6h9uf">Scanning folder structure...</p></div>'),vs=w('<div class="uno-laclbo"><p class="uno-dl0t86"> </p></div>'),gs=w('<div class="uno-tm086o"><button><h1 class="uno-brv6u2">Select Root Folder</h1> <p class="uno-l6h9uf">Select the folder containing manga subfolders with .zip files</p> <input class="uno-qya2ty" type="file"/></button> <!> <!></div>');function fs(E,t){Ke(t,!0);let i=Te(t,"guidedState",7),s=Te(t,"class",3,""),b=T(null),P=T(!1);async function d(y){c(P,!0);const Z=y.target,ee=Array.from(Z.files??[]),U=[];for(const V of ee){const X=(V.webkitRelativePath||V.name).split("/").filter(Boolean);if(X.length>=2){const q=X[0],F=X[0],j=V.name.split(".").pop()?.toLowerCase();(j==="zip"||j==="cbz")&&U.push({file:V,mangaFolderName:q,mangaFolderPath:F})}}i().rootFolderFiles=ee,i().zipFiles=U.map(V=>({...V,status:oe.PENDING})),c(P,!1),t.onDone()}function Q(y){e(b)?.click()}var C=gs(),k=r(C);k.__click=Q;var z=l(r(k),4);z.webkitdirectory=!0,z.multiple=!0,z.__change=d,at(z,y=>c(b,y),()=>e(b)),a(k);var H=l(k,2);{var se=y=>{var Z=ps();h(y,Z)};D(H,y=>{e(P)&&y(se)})}var M=l(H,2);{var K=y=>{var Z=vs(),ee=r(Z),U=r(ee);a(ee),a(Z),W(()=>x(U,`Found ${i().zipFiles.length??""} zip file${i().zipFiles.length===1?"":"s"}`)),h(y,Z)};D(M,y=>{i().zipFiles.length>0&&y(K)})}a(C),W(()=>{Ee(k,1,`uno-a4tqjo ${s()??""}`),k.disabled=e(P)}),h(E,C),Xe()}$e(["click","change"]);var hs=w('<button type="button"><div class="uno-bpywdh"><p class="uno-98yf80"> </p> <p class="uno-42pivu"> </p></div> <input type="checkbox" class="uno-5onsv4"/></button>'),ms=w('<div class="uno-o40niy"><div class="uno-iuhcpm"><h3 class="uno-0lb4rh"> </h3> <button type="button" class="uno-phh4jd"> </button></div> <div class="uno-fb55wk"></div></div>'),_s=w('<div><div class="uno-iuhcpm"><h2 class="uno-iyer7g">Select Zip Files to Process</h2> <button type="button" class="uno-f45w65"> </button></div> <p class="uno-ok9xip"> </p> <div class="uno-yjimjk"></div> <button type="button" class="uno-3s4o5e"> </button></div>');function bs(E,t){Ke(t,!0);let i=Te(t,"guidedState",7),s=Te(t,"class",3,"");function b(U){i().selectedZipFiles.indexOf(U)>=0?i().selectedZipFiles=i().selectedZipFiles.filter(ie=>ie!==U):i().selectedZipFiles=[...i().selectedZipFiles,U]}function P(U){const V=Array.from(i().zipFilesByMangaFolder.get(U)??[]);if(V.every(X=>i().selectedZipFiles.includes(X.file)))i().selectedZipFiles=i().selectedZipFiles.filter(X=>!V.some(q=>q.file===X));else{const X=V.map(q=>q.file).filter(q=>!i().selectedZipFiles.includes(q));i().selectedZipFiles=[...i().selectedZipFiles,...X]}}function d(){i().selectedZipFiles.length===i().zipFiles.length?i().selectedZipFiles=[]:i().selectedZipFiles=i().zipFiles.map(U=>U.file)}const Q=be(()=>i().zipFiles.length>0&&i().selectedZipFiles.length===i().zipFiles.length),C=be(()=>i().zipFilesByMangaFolder);var k=_s(),z=r(k),H=l(r(z),2);H.__click=d;var se=r(H,!0);a(H),a(z);var M=l(z,2),K=r(M);a(M);var y=l(M,2);Ue(y,21,()=>Array.from(e(C).entries()),We,(U,V)=>{var ie=be(()=>Ft(e(V),2));let X=()=>e(ie)[0],q=()=>e(ie)[1];var F=ms(),j=r(F),te=r(j),ye=r(te,!0);a(te);var ve=l(te,2);ve.__click=()=>P(X());var le=r(ve);a(ve),a(j);var Ne=l(j,2);Ue(Ne,21,q,We,(de,ce)=>{const ge=be(()=>i().selectedZipFiles.includes(e(ce).file));var ae=hs();ae.__click=()=>b(e(ce).file);var fe=r(ae),he=r(fe),Fe=r(he,!0);a(he);var we=l(he,2),B=r(we);a(we),a(fe);var ue=l(fe,2);Pt(ue),a(ae),W(Pe=>{Ee(ae,1,`uno-ik4adi ${e(ge)?"uno-1k75dk":""}`),x(Fe,e(ce).file.name),x(B,`Size: ${Pe??""} MB`),Gt(ue,e(ge))},[()=>(e(ce).file.size/(1024*1024)).toFixed(2)]),h(de,ae)}),a(Ne),a(F),W(de=>{x(ye,X()),x(le,`${de??""} (${q().length??""})`)},[()=>q().every(de=>i().selectedZipFiles.includes(de.file))?"Deselect All":"Select All"]),h(U,F)}),a(y);var Z=l(y,2);Z.__click=function(...U){t.onDone?.apply(this,U)};var ee=r(Z);a(Z),a(k),W(()=>{Ee(k,1,`uno-grwdkw ${s()??""}`),x(se,e(Q)?"Deselect All":"Select All"),x(K,`${i().selectedZipFiles.length??""} of ${i().zipFiles.length??""} zip file${i().zipFiles.length===1?"":"s"} selected`),Z.disabled=i().selectedZipFiles.length===0,x(ee,`Continue to Processing (${i().selectedZipFiles.length??""} selected)`)}),h(E,k),Xe()}$e(["click"]);var Es=w('<p class="uno-a54tpo"> </p>'),ws=w('<div class="uno-cqccui"><p class="uno-nsysfu"> </p> <span> </span></div> <!>',1),Is=w('<p class="uno-b7m48p">No zip file selected</p>'),Ns=w('<button type="button" class="uno-qm31yq"> </button>'),xs=w('<p class="uno-b7m48p">No more zip files to process</p>'),Ss=w("<div><!></div>"),ys=w('<p class="uno-b7m48p">All zip files have been completed</p>'),As=w('<button type="button" class="uno-4y4l6m"> </button>'),Fs=w('<div class="uno-2db0z0"><h3 class="uno-tniapq"> </h3> <div class="uno-ouywhe"></div></div>'),Rs=w('<button type="button" class="uno-qy4bc0"> </button>'),Ps=w('<div class="uno-2db0z0"><h3 class="uno-9iz2qs"> </h3> <div class="uno-ouywhe"></div></div>'),Gs=w('<div><div class="uno-0ia1w6 border-surface-hover"><h2 class="uno-1c2kr2">Zip Processing</h2> <div class="uno-cqccui"><span class="uno-d1zaof">Automation (experimental): <span> </span></span> <button type="button"> </button></div></div> <div class="uno-usvt4c"><div class="uno-cqccui"><span class="uno-4ezlml"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-1l1bmy"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-e545zy"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-mg1fk7"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-ip18dj"></span> <span class="uno-b7m48p"> </span></div></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Current Zip File</h3> <!></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Next Zip File</h3> <!></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Select Zip File</h3> <!></div> <!> <!></div>');function Ds(E,t){Ke(t,!0);let i=Te(t,"guidedState",7),s=Te(t,"class",3,"");const b=ut(ft);if(!b)throw new Error("MangaProcessingTabs must be used within a component that provides AutomationState context");function P(){if(i().moveToNextZip()){const o=i().currentZip;o&&t.onZipSelected(o.file)}}function d(o){const u=i().zipFiles.find(m=>m.file.name===o);if(u){const m=i().zipFiles.findIndex(G=>G.file===u.file);m>=0&&(i().currentZipIndex=m,t.onZipSelected(u.file))}}function Q(){b.enabled?b.disable():b.enable()}const C=be(()=>i().currentZip?.file.name??null),k=be(()=>i().warningZips.map(o=>o.file.name)),z=be(()=>i().errorZips.map(o=>o.file.name)),H=be(()=>i().unprocessedZips.map(o=>o.file.name)),se=be(()=>i().nextZip?.file.name??null),M=be(()=>i().pendingZips.length===0&&(i().warningZips.length>0||i().errorZips.length>0));Re(()=>{e(M)&&b.isActive&&b.disable()});let K=T(null);Re(()=>{c(K,i().currentZip?.file.name??null,!0)}),Re(()=>{const o=e(K);if(o){const u=i().currentZip?.file.name??null;o!==u&&d(o)}});const y=be(()=>({pending:i().pendingZips.length,warning:i().warningZips.length,error:i().errorZips.length,completed:i().completedZips.length,processing:i().processingZips.length}));var Z=Gs(),ee=r(Z),U=l(r(ee),2),V=r(U),ie=l(r(V)),X=r(ie,!0);a(ie),a(V);var q=l(V,2);q.__click=Q;var F=r(q,!0);a(q),a(U),a(ee);var j=l(ee,2),te=r(j),ye=l(r(te),2),ve=r(ye);a(ye),a(te);var le=l(te,2),Ne=l(r(le),2),de=r(Ne);a(Ne),a(le);var ce=l(le,2),ge=l(r(ce),2),ae=r(ge);a(ge),a(ce);var fe=l(ce,2),he=l(r(fe),2),Fe=r(he);a(he),a(fe);var we=l(fe,2),B=l(r(we),2),ue=r(B);a(B),a(we),a(j);var Pe=l(j,2),Ce=l(r(Pe),2);{var Ge=o=>{var u=ws(),m=De(u),G=r(m),A=r(G,!0);a(G);var O=l(G,2),$=r(O,!0);a(O),a(m);var L=l(m,2);{var re=ne=>{var Ie=Es(),xe=r(Ie);a(Ie),W(()=>x(xe,`Manga Folder: ${i().currentZip.mangaFolderName??""}`)),h(ne,Ie)};D(L,ne=>{i().currentZip&&ne(re)})}W(()=>{x(A,e(C)),Ee(O,1,`uno-ielryd ${i().currentZip?.status===oe.PROCESSING?"uno-kxa2ln":i().currentZip?.status===oe.COMPLETED?"uno-b1425w":i().currentZip?.status===oe.ERROR?"uno-isu16c":i().currentZip?.status===oe.WARNING?"uno-enplrj":"uno-jwlzg2"}`),x($,i().currentZip?.status??"UNKNOWN")}),h(o,u)},je=o=>{var u=Is();h(o,u)};D(Ce,o=>{e(C)?o(Ge):o(je,!1)})}a(Pe);var Ze=l(Pe,2),Je=l(r(Ze),2);{var Qe=o=>{var u=Ns();u.__click=P;var m=r(u);a(u),W(()=>{u.disabled=b.enabled,x(m,`Process: ${e(se)??""}`)}),h(o,u)},p=o=>{var u=xs();h(o,u)};D(Je,o=>{e(se)?o(Qe):o(p,!1)})}a(Ze);var f=l(Ze,2),v=l(r(f),2);{var S=o=>{var u=Ss(),m=r(u);Dt(m,{get items(){return e(H)},class:"uno-qbg2l1",get selectedItem(){return e(K)},set selectedItem(G){c(K,G,!0)}}),a(u),W(()=>Ee(u,1,Tt(b.enabled?"opacity-50 pointer-events-none":""))),h(o,u)},R=o=>{var u=ys();h(o,u)};D(v,o=>{e(H).length>0?o(S):o(R,!1)})}a(f);var N=l(f,2);{var I=o=>{var u=Fs(),m=r(u),G=r(m);a(m);var A=l(m,2);Ue(A,21,()=>e(k),We,(O,$)=>{var L=As();L.__click=()=>d(e($));var re=r(L,!0);a(L),W(()=>{L.disabled=b.enabled,x(re,e($))}),h(O,L)}),a(A),a(u),W(()=>x(G,`‚ö†Ô∏è Warning Zips (${e(k).length??""})`)),h(o,u)};D(N,o=>{e(k).length>0&&o(I)})}var n=l(N,2);{var g=o=>{var u=Ps(),m=r(u),G=r(m);a(m);var A=l(m,2);Ue(A,21,()=>e(z),We,(O,$)=>{var L=Rs();L.__click=()=>d(e($));var re=r(L,!0);a(L),W(()=>{L.disabled=b.enabled,x(re,e($))}),h(O,L)}),a(A),a(u),W(()=>x(G,`‚ùå Error Zips (${e(z).length??""})`)),h(o,u)};D(n,o=>{e(z).length>0&&o(g)})}a(Z),W(()=>{Ee(Z,1,`uno-s0eao9 ${s()??""}`),Ee(ie,1,`uno-cvk0wv ${b.enabled?"uno-ikj4sb":"uno-je1lgh"}`),x(X,b.enabled?"ON":"OFF"),Ee(q,1,`uno-sv39f1 ${b.enabled?"uno-oxxvv6":"uno-dimr5c"}`),x(F,b.enabled?"üîÑ Turn OFF":"‚ñ∂Ô∏è Turn ON"),x(ve,`Pending: ${e(y).pending??""}`),x(de,`Processing: ${e(y).processing??""}`),x(ae,`Warning: ${e(y).warning??""}`),x(Fe,`Error: ${e(y).error??""}`),x(ue,`Completed: ${e(y).completed??""}`)}),h(E,Z),Xe()}$e(["click"]);function Ts(E){const t=Ct(E,0);return Zt(E,t,0,[])}function Cs(E,t="v(\\d+)"){const i=new RegExp(t,"i"),s=E.match(i);return s&&s[1]?s[1].replace(/^0+/,"")||"0":null}function Zs(E,t="c(\\d+(?:\\.\\d+){0,2})"){const i=new RegExp(t,"i"),s=E.match(i);if(s&&s[1]){const b=s[1];if(b.includes(".")){const P=b.split(".");return[P[0].replace(/^0+/,"")||"0",...P.slice(1)].join(".")}else return b.replace(/^0+/,"")||"0"}return null}function Ls(E){const t=/MD-(\d+)/i,i=E.match(t);return i?i[1]:null}var Os=w('<span class="uno-lzl9l3 svelte-m4i47p">Removed</span>'),ks=w('<button type="button" class="uno-lj049g svelte-m4i47p" title="Edit volume and chapter" aria-label="Edit volume and chapter"><div class="uno-smkhzc svelte-m4i47p"></div></button>'),zs=w('<div class="uno-7qt2lg svelte-m4i47p"><div class="uno-m5mbjf svelte-m4i47p"></div> <span class="svelte-m4i47p">Restore</span></div>'),Ms=w('<div class="uno-7qt2lg svelte-m4i47p"><div class="uno-9z7ooq svelte-m4i47p"></div> <span class="svelte-m4i47p">Remove</span></div>'),Us=w('<span class="uno-2et217 svelte-m4i47p"> </span>'),Ws=w('<div class="uno-58lieu svelte-m4i47p">Loading combinations...</div>'),js=w('<div class="uno-58lieu svelte-m4i47p">No volume/chapter combinations available</div>'),Ys=w('<button type="button"><div class="uno-l6o6ga svelte-m4i47p"><span class="svelte-m4i47p"> </span></div></button>'),Vs=w('<div class="uno-iqadiw svelte-m4i47p" role="presentation"><div class="uno-k7cjbm svelte-m4i47p"><!></div></div>'),qs=w('<div><div class="uno-rzokcw svelte-m4i47p"><div class="uno-n4d6p5 svelte-m4i47p"><span class="uno-upv063 svelte-m4i47p"> </span> <!> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Vol:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Ch:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div> <!> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Pages:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div></div> <button type="button"><!></button></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Title:</span> <div class="uno-aqzn48 svelte-m4i47p"><!> <!></div></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Groups:</span> <!></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Path:</span> <span class="uno-nggqeg svelte-m4i47p"> </span></div></div> <!>',1);function Bs(E,t){if(Ke(t,!0),!ut(wt))throw new Error("GuidedChapterEditor must be used within a component that provides TargetingState context");let s=Te(t,"chapter",7),b=Te(t,"class",3,""),P=T(!1),d=T(ze([])),Q=T(!1),C=T(null),k=T(null),z=T(null),H=T(null);function se(){s().isDeleted=!s().isDeleted}async function M(){if(!e(P)){e(C)&&c(H,e(C).getBoundingClientRect(),!0),c(P,!0),c(Q,!0);try{const n=s().associatedSeries?.seriesId;if(!n){console.warn("No series ID available for chapter"),c(P,!1);return}await He.load(),c(d,await He.getUniqueVolumeChapterCombinations(n),!0)}catch(n){console.error("Failed to load volume/chapter combinations:",n)}finally{c(Q,!1)}}}function K(){c(P,!1),c(z,null),c(H,null)}function y(n,g){const o=g?.includes("[no group]")??!1;if(g&&!o){for(const m of Object.keys(n.groupTitles))if(g.includes(m)){const G=n.groupTitles[m];if(G&&G.trim()!=="")return G}}if(o&&n.ungroupedTitles.length>0||n.ungroupedTitles.length>0)return n.ungroupedTitles[0];const u=Object.keys(n.groupTitles);return u.length>0?n.groupTitles[u[0]]:null}function Z(n){s().manuallyEditedFields.has("volume")||(s().originalFieldValues.has("volume")||s().originalFieldValues.set("volume",s().chapterVolume),s().manuallyEditedFields.add("volume")),s().manuallyEditedFields.has("chapter")||(s().originalFieldValues.has("chapter")||s().originalFieldValues.set("chapter",s().chapterNumber),s().manuallyEditedFields.add("chapter")),s().manuallyEditedFields.has("title")||(s().originalFieldValues.has("title")||s().originalFieldValues.set("title",s().chapterTitle),s().manuallyEditedFields.add("title")),s().chapterVolume=n.volume||null,s().chapterNumber=n.chapter||null,s().chapterTitle=y(n.info,s().originalFolderPath),K()}function ee(n){const g=n.volume||"N/A",o=n.chapter||"N/A",u=y(n.info,s().originalFolderPath),m=u?` - ${u}`:"";return`Vol ${g}, Ch ${o}${m}`}function U(){if(!e(H))return;const n=e(H),g=window.innerHeight,o=window.innerWidth,u=4,m=256;let G=m;if(e(k)){const et=e(k).getBoundingClientRect().height;G=Math.min(et,m)}const A=g-n.bottom-u,O=n.top-u,$=A<m&&O>A;let L;$?(L=n.top-G-u,L<u&&(L=u)):(L=n.bottom+u,L+G>g&&(L=Math.max(u,g-G-u)));let re=n.left;const ne=320,Ie=Math.min(400,o-u*2),xe=Math.max(ne,Math.min(Ie,n.width));re+xe>o-u&&(re=o-xe-u),re<u&&(re=u),c(z,{top:L,left:re,width:xe},!0)}Re(()=>{if(e(P)){if(!e(H)){c(z,null);return}requestAnimationFrame(()=>{requestAnimationFrame(()=>{U()})});const n=()=>U(),g=u=>{const m=u.target;e(k)&&!e(k).contains(m)&&e(C)&&!e(C).contains(m)&&K()},o=setTimeout(()=>{window.addEventListener("resize",n),document.addEventListener("click",g,!0)},10);return()=>{clearTimeout(o),window.removeEventListener("resize",n),document.removeEventListener("click",g,!0)}}else c(z,null)}),Re(()=>{e(P)&&e(k)&&requestAnimationFrame(()=>{U()})});var V=qs(),ie=De(V),X=r(ie),q=r(X),F=r(q),j=r(F);a(F);var te=l(F,2);{var ye=n=>{var g=Os();h(n,g)};D(te,n=>{s().isDeleted&&n(ye)})}var ve=l(te,2),le=l(r(ve),2),Ne=r(le,!0);a(le),a(ve);var de=l(ve,2),ce=l(r(de),2),ge=r(ce,!0);a(ce),a(de);var ae=l(de,2);{var fe=n=>{var g=ks();g.__click=o=>{o.stopPropagation(),M()},at(g,o=>c(C,o),()=>e(C)),h(n,g)};D(ae,n=>{s().associatedSeries?.seriesId&&n(fe)})}var he=l(ae,2),Fe=l(r(he),2),we=r(Fe,!0);a(Fe),a(he),a(q);var B=l(q,2);B.__click=se;var ue=r(B);{var Pe=n=>{var g=zs();h(n,g)},Ce=n=>{var g=Ms();h(n,g)};D(ue,n=>{s().isDeleted?n(Pe):n(Ce,!1)})}a(B),a(X);var Ge=l(X,2),je=l(r(Ge),2),Ze=r(je);Lt(Ze,{textClass:"text-sm text-app font-medium",fieldName:"title",get chapter(){return s()},get value(){return s().chapterTitle},set value(n){s().chapterTitle=n}});var Je=l(Ze,2);{var Qe=n=>{var g=Us(),o=r(g);a(g),W(()=>x(o,`(${(s().originalFolderPath||"Untitled")??""})`)),h(n,g)};D(Je,n=>{s().chapterTitle||n(Qe)})}a(je),a(Ge);var p=l(Ge,2),f=l(r(p),2);Ot(f,{fieldName:"groups",get chapter(){return s()},get groups(){return s().associatedGroup},set groups(n){s().associatedGroup=n}}),a(p);var v=l(p,2),S=l(r(v),2),R=r(S,!0);a(S),a(v),a(ie);var N=l(ie,2);{var I=n=>{var g=Vs();g.__click=A=>A.stopPropagation();var o=r(g),u=r(o);{var m=A=>{var O=Ws();h(A,O)},G=A=>{var O=Me(),$=De(O);{var L=ne=>{var Ie=js();h(ne,Ie)},re=ne=>{var Ie=Me(),xe=De(Ie);Ue(xe,17,()=>e(d),We,(et,me)=>{var pe=Ys();pe.__click=()=>Z(e(me));var Ae=r(pe),Le=r(Ae),Ye=r(Le,!0);a(Le),a(Ae),a(pe),W(Ve=>{Ee(pe,1,`uno-ss9yjz ${s().chapterVolume===e(me).volume&&s().chapterNumber===e(me).chapter?"uno-eokg3r":""}`,"svelte-m4i47p"),x(Ye,Ve)},[()=>ee(e(me))]),h(et,pe)}),h(ne,Ie)};D($,ne=>{e(d).length===0?ne(L):ne(re,!1)},!0)}h(A,O)};D(u,A=>{e(Q)?A(m):A(G,!1)})}a(o),a(g),at(g,A=>c(k,A),()=>e(k)),W(()=>kt(g,`top: ${e(z).top??""}px; left: ${e(z).left??""}px; width: ${e(z).width??""}px;`)),h(n,g)};D(N,n=>{e(P)&&e(z)&&n(I)})}W(()=>{Ee(ie,1,`uno-3rf4hu ${s().isDeleted?"uno-d3zfvr":""} ${b()??""}`,"svelte-m4i47p"),x(j,`#${t.index+1}`),x(Ne,s().chapterVolume??"N/A"),x(ge,s().chapterNumber??"N/A"),x(we,s().pages.length),Ee(B,1,`uno-lto8ne ${s().isDeleted?"uno-ld06wt":"uno-far8pd"}`,"svelte-m4i47p"),gt(B,"title",s().isDeleted?"Restore chapter":"Mark as removed"),x(R,s().originalFolderPath)}),h(E,V),Xe()}$e(["click"]);class Hs{#e=T(null);get legacyToWeebdexMap(){return e(this.#e)}set legacyToWeebdexMap(t){c(this.#e,t,!0)}#t=T(null);get weebdexToLegacyMap(){return e(this.#t)}set weebdexToLegacyMap(t){c(this.#t,t,!0)}#s=T(!1);get isLoading(){return e(this.#s)}set isLoading(t){c(this.#s,t,!0)}#i=T(null);get loadError(){return e(this.#i)}set loadError(t){c(this.#i,t,!0)}loadPromise=null;async load(){if(this.legacyToWeebdexMap!==null&&this.weebdexToLegacyMap!==null)return;if(this.loadPromise)return this.loadPromise;this.isLoading=!0,this.loadError=null;let t,i;this.loadPromise=new Promise((s,b)=>{t=s,i=b});try{const s=ns("/weebdex_lookup.csv"),b=await fetch(s);if(!b.ok)throw new Error(`Failed to fetch CSV: ${b.status} ${b.statusText}`);const P=await b.text(),{legacyToWeebdex:d,weebdexToLegacy:Q}=this.parseCSV(P);this.legacyToWeebdexMap=d,this.weebdexToLegacyMap=Q,t()}catch(s){this.loadError=s instanceof Error?s:new Error("Unknown error loading CSV"),i(this.loadError)}finally{this.isLoading=!1}return this.loadPromise}async ensureLoaded(){if(!(this.legacyToWeebdexMap!==null&&this.weebdexToLegacyMap!==null)){if(this.loadPromise){await this.loadPromise;return}await this.load()}}parseCSV(t){const i=zt(t,{columns:!0,skip_empty_lines:!0,trim:!0}),s=new vt,b=new vt;for(const P of i){const d=P.weebdex_id?.trim()||"",Q=P.legacy_id?.trim()||"";d&&Q&&(s.set(Q,d),b.set(d,Q))}return{legacyToWeebdex:s,weebdexToLegacy:b}}async getWeebdexIdFromLegacyId(t){return await this.ensureLoaded(),this.legacyToWeebdexMap===null?null:this.legacyToWeebdexMap.get(t)||null}}const bt=new Hs;var Ks=w('<p class="uno-8520et"> </p>'),Xs=w('<div class="uno-vsugad"><div class="uno-pj4440"></div> <p class="uno-hw2z5w"> </p> <!></div>'),$s=w(`<p class="uno-stwt3u">‚ö†Ô∏è Waiting for series ID - Automation will skip this zip. Please select a series
							above.</p>`),Js=w('<p class="uno-stwt3u">‚ö†Ô∏è Ready with warnings - Automation will skip this zip. You can still upload manually.</p>'),Qs=w("<p> </p>"),ei=w("<p>‚Ä¢ Chapter dump lookup failed</p>"),ti=w("<p> </p>"),si=w("<p> </p>"),ii=w('<div class="uno-hqujre"><!> <div class="uno-4ixn7j"><!> <!> <!> <!></div></div>'),ai=w('<span class="uno-czmb1a">Removed</span>'),ri=w('<div class="uno-2umhxz"></div>'),ni=w('<div class="uno-kp2ftc"></div>'),oi=w('<div><div class="uno-py2y93"><div class="uno-nxlaaf"><p class="uno-39vbxq"> </p> <!></div> <p class="uno-dsgwse"> </p></div> <button type="button"><!></button></div>'),li=w(`<div class="uno-bi16xf"><div class="uno-nnnwwl"><div class="uno-djaa0e"><p class="uno-apr5a0"> </p> <p class="uno-lp9tww">The following chapters already exist on WeebDex with matching groups. You can mark
								them as removed to skip uploading.</p></div> <button type="button" class="uno-3jkjwc" title="Mark all duplicate chapters as removed">Removed duplicate chapters</button></div> <div class="uno-56cpuz"></div></div>`),ui=w('<div class="uno-hemz07"><div class="uno-ns83sq"><p class="uno-0zsd1s"> </p></div> <div class="uno-f2o4wl"><h3 class="uno-otxjpc">Series Selection (Required)</h3> <!> <!> <!></div> <!> <!> <div class="uno-f2o4wl"><h3 class="uno-otxjpc">Detected Chapters</h3> <div class="uno-xqlxhl"></div></div> <button type="button" class="uno-d93lfx"> </button></div>'),ci=w('<div class="uno-6nb6x4"><p class="uno-dillda">‚úì Upload completed successfully!</p></div>'),di=w('<div><h2 class="uno-67n1yz"> </h2> <!></div>');function pi(E,t){Ke(t,!0),Mt({useWebWorkers:!1});let i=Te(t,"class",3,"");const s=new Ut;lt(wt,s);const b=ut(It);if(!b)throw new Error("MangaProcessor must be used within a component that provides ApiAuthContext");const P=ut(ft);let d=T(ze(_.LOADING)),Q=T(null),C=T(ze([])),k=T(!1),z=T(null),H=T(null),se=T(null),M=T(ze([])),K=T(!1),y=T(ze([])),Z=T(0),ee=T(null);const U=["jpg","jpeg","png","gif","webp","cbz","zip","xml"];Re(()=>{t.zipFile&&(c(se,null),c(M,[],!0),c(K,!1),c(y,[],!0),c(Z,0),c(ee,null),V())});async function V(){try{if(await q(),await F(),!s.seriesId){c(d,_.READY_WARNING,!0);return}c(d,_.APPLYING_REGEX,!0),await j(),await te(),await ye(),await ve(),await ce(),ae()?c(d,_.READY_WARNING,!0):c(d,_.READY,!0)}catch(p){console.error("Error in processing pipeline:",p),c(ee,p instanceof Error?p.message:"Processing failed",!0),t.guidedState.setZipStatus(t.zipFile,oe.ERROR),c(d,_.READY_WARNING,!0),t.onProcessingComplete("error")}}async function ie(p){const f=p.name.split(".").pop()?.toLowerCase();if(!(f==="cbz")&&!(f==="zip"))throw new Error(`Unsupported archive format: ${f}`);console.log(`Extracting ${f} file:`,p.name),c(z,p.name,!0);const R=new $t(new Jt(p)),N=await R.getEntries(),I=[],n=p.name.replace(/\.(cbz|zip)$/i,""),g=p.webkitRelativePath||p.name;for(const o of N){if(!o.filename||o.directory)continue;const u=o.filename.split(".").pop()?.toLowerCase();if(!u||!U.includes(u))continue;const m=new TransformStream,G=new Response(m.readable).blob();await o.getData(m.writable);let A=await G;if(!A.type){const ne=X(u);A=new Blob([A],{type:ne})}const O=o.filename,$=O.split("/").pop()??O,L=g.includes("/")?`${g.split("/").slice(0,-1).join("/")}/${n}/${O}`:`${n}/${O}`,re=new File([A],$,{type:A.type});Object.defineProperty(re,"webkitRelativePath",{value:L,writable:!1,enumerable:!0,configurable:!0}),I.push(re)}return await R.close(),c(z,null),I}function X(p){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp"}[p]||"application/octet-stream"}async function q(){c(d,_.LOADING,!0),s.reset(),c(d,_.EXTRACTING,!0);let p=[];try{p=await ie(t.zipFile)}catch(v){throw console.error(`Error extracting ${t.zipFile.name}:`,v),c(ee,v instanceof Error?v.message:"Failed to extract archive",!0),v}c(Q,Wt(p),!0);const f=Ts(e(Q));c(C,await Promise.all(f.map(async v=>{const S=Cs(v.name),R=Zs(v.name),N=v.files.filter(I=>I.type===jt.CHAPTER_PAGE).map((I,n)=>new Yt(I.file.name,n,I.file,Vt.NOT_STARTED,0,null,null,!1,I.type));return new qt(v.path,v.name,S,R,new mt,new Bt,N,pt.NOT_STARTED,0,null,null,v,!1,"en")})),!0),e(C).sort((v,S)=>{if(v.chapterVolume&&S.chapterVolume){const R=String(v.chapterVolume).localeCompare(String(S.chapterVolume),void 0,{numeric:!0,sensitivity:"base"});if(R!==0)return R}else{if(v.chapterVolume)return-1;if(S.chapterVolume)return 1}return v.chapterNumber&&S.chapterNumber?String(v.chapterNumber).localeCompare(String(S.chapterNumber),void 0,{numeric:!0,sensitivity:"base"}):v.chapterNumber?-1:S.chapterNumber?1:0}),s.chapterStates=e(C)}async function F(){c(d,_.SERIES_LOOKUP,!0);const p=Ls(t.zipFile.name);if(p)try{await bt.load();const f=await bt.getWeebdexIdFromLegacyId(p);f?(s.seriesId=f,console.log(`Auto-detected series ID from MD-####: ${p} -> ${f}`)):console.log(`No WeebDex ID found for MangaDex ID: ${p}`)}catch(f){console.warn(`Failed to lookup WeebDex ID for MangaDex ID ${p}:`,f)}s.seriesId&&s.chapterStates.forEach(f=>{f.associatedSeries||(f.associatedSeries=new mt),f.associatedSeries.seriesId=s.seriesId??""})}async function j(){c(d,_.CHAPTER_LOOKUP,!0),s.seriesId&&await He.load()}async function te(){if(c(d,_.LOADING_GROUPS,!0),!s.seriesId)return;if(!await He.hasSeriesEntries(s.seriesId)){console.warn("No entries found in chapter dump for this series"),c(K,!0);return}const f=await He.getAllGroupNames(s.seriesId);if(f.length===0){console.log("No groups found in chapter dump, but series has entries (likely all ungrouped)"),s.availableScanGroups=[];return}const v=[],S=[];for(const R of f)try{const N=await Ht(R);if(N.data){const I=N.data.find(n=>n.name===R);if(I){const n=new Kt;n.groupId=I.id,n.groupName=I.name,v.push(n)}else S.push(R)}else S.push(R)}catch(N){console.warn(`Failed to lookup group "${R}":`,N),S.push(R)}c(y,S,!0),S.length>0&&c(K,!0),s.availableScanGroups=v}async function ye(){c(d,_.APPLYING_GROUPS,!0),await Ne()}async function ve(){if(c(d,_.APPLYING_TITLES,!0),!s.seriesId)return;const p=await de();c(Z,p,!0),p>0&&c(K,!0)}Re(()=>{s.seriesId&&(e(d)===_.READY||e(d)===_.READY_WARNING)&&s.seriesId!==e(se)&&(c(se,s.seriesId,!0),le())});async function le(){try{if(await F(),!s.seriesId)return;c(d,_.APPLYING_REGEX,!0),await j(),await te(),await ye(),await ve(),await ce(),ae()?c(d,_.READY_WARNING,!0):c(d,_.READY,!0)}catch(p){console.error("Error in processing pipeline:",p),c(d,_.READY_WARNING,!0)}}async function Ne(){for(const p of s.chapterStates){if(!p.originalFolderPath)continue;const f=s.availableScanGroups.filter(v=>p.originalFolderPath?.includes(v.groupName)??!1);if(f.length>0){const v=p.associatedGroup.groupIds??[],S=new Set(v);for(const R of f)S.has(R.groupId)||S.add(R.groupId);p.associatedGroup.groupIds=Array.from(S)}}}async function de(){if(!s.seriesId)return 0;const p=new Map;for(const v of s.availableScanGroups)p.set(v.groupId,v.groupName);let f=0;for(const v of s.chapterStates){const S=v.originalFolderPath?.includes("[no group]")??!1,R=v.associatedGroup.groupIds??[];if(R.length===0&&!S){f++;continue}const N=R.map(o=>p.get(o)).filter(o=>o!==void 0);if(N.length===0&&!S){f++;continue}const I=await He.getChapterInfo(s.seriesId,v.chapterVolume,v.chapterNumber);if(!I){f++;continue}let n=null,g=!1;for(const o of N)if(o in I.groupTitles){n=I.groupTitles[o],g=!0,console.log(`found group name match for group: ${o} with title: ${n}`);break}!g&&S&&I.ungroupedTitles.length>0&&(n=I.ungroupedTitles[0],g=!0,console.log(`found ungrouped title match for chapter: ${v.originalFolderPath} with title: ${n}`)),g?v.chapterTitle=n:f++}return f}async function ce(){if(s.seriesId)try{const p=await Xt(s.seriesId),f=[],v=new Map;for(const N of p.chapters){const I=N.volume||"none",n=N.chapter,g=`${I}:${n}`;v.set(g,N)}const S=N=>{const I=new Set;if(p.groups)for(const n of N){const g=p.groups[n];g&&I.add(g.id)}return I},R=(N,I)=>{if(N.size!==I.size)return!1;for(const n of N)if(!I.has(n))return!1;return!0};for(const N of s.chapterStates){const I=N.chapterVolume||"none",n=N.chapterNumber;if(!n)continue;const g=`${I}:${n}`,o=v.get(g);if(o&&o.entries&&Object.keys(o.entries).length>0){const u=new Set(N.associatedGroup.groupIds??[]);if(u.size===0)continue;let m=null;for(const G of Object.values(o.entries)){const A=S(G.groups);if(R(u,A)){m=G;break}}if(m){const G=S(m.groups),A=[];for(const O of G){const $=p.groups?.find(L=>L.id===O);$?A.push(`${$.name} (${$.id})`):A.push(`Unknown Group (${O})`)}f.push({chapter:N,existingGroups:A.length>0?A:["Unknown groups"]})}}}c(M,f,!0)}catch(p){console.error("Error checking for duplicates:",p),c(M,[],!0)}}function ge(p){if(e(d)!==_.UPLOADING)return;c(d,_.COMPLETED,!0);const f=p?"success":"error";t.guidedState.setZipStatus(t.zipFile,p?oe.COMPLETED:oe.ERROR),t.onProcessingComplete(f)}function ae(){return e(M).length>0||e(K)||e(y).length>0||e(Z)>0}function fe(){return{hasDuplicates:e(M).length>0,duplicateCount:e(M).length,dumpLookupFailed:e(K),failedGroups:e(y).length,failedTitles:e(Z)}}function he(){return e(d)===_.READY&&(e(se)===s.seriesId||!s.seriesId)}Re(()=>{if(!P?.isActive)return;const f=e(d),v=s.seriesId,S=e(se),R=f===_.READY||f===_.READY_WARNING;if(!R)return;console.log("Automation: Effect triggered, checking state",{step:f,seriesId:v,lastSeriesId:S,shouldCheck:R});const N=setTimeout(()=>{Fe()},500);return()=>clearTimeout(N)});async function Fe(){if(!P?.isActive){console.log("Automation: Not active");return}if(e(d)===_.READY_WARNING){console.log("Automation: READY_WARNING state detected, marking as warning and skipping"),t.guidedState.setZipStatus(t.zipFile,oe.WARNING),t.onProcessingComplete("warning");return}if(!he()){console.log("Automation: Not ready",{step:e(d),seriesId:s.seriesId,lastProcessedSeriesId:e(se)});return}console.log("Automation: Checking zip file",t.zipFile.name);const p=t.guidedState.pendingZips,f=t.guidedState.warningZips.length>0||t.guidedState.errorZips.length>0;if(p.length===0&&f){console.log("Automation: Disabling - only warnings/errors remain"),P.disable();return}console.log("Automation: No issues, starting upload",{canStartUpload:e(B),hasSeriesId:!!s.seriesId,nonDeletedChapters:e(ue).length}),e(B)&&s.seriesId&&e(ue).length>0?we()?console.log("Automation: Upload started successfully"):(console.warn("Automation: Failed to start upload, marking as error"),t.guidedState.setZipStatus(t.zipFile,oe.ERROR),t.onProcessingComplete("error")):(console.warn("Automation: Missing requirements for upload",{canStartUpload:e(B),hasSeriesId:!!s.seriesId,nonDeletedChapters:e(ue).length}),t.guidedState.setZipStatus(t.zipFile,oe.WARNING),t.onProcessingComplete("warning"))}function we(){return b.apiToken?s.seriesId?s.chapterStates.length===0?(alert("No chapters to upload"),!1):!e(B)||e(ue).length===0?!1:(c(d,_.UPLOADING,!0),t.guidedState.setZipStatus(t.zipFile,oe.PROCESSING),!0):(alert("Please set a series ID first"),!1):(alert("Please set up API authentication first"),!1)}Re(()=>{if(e(d)===_.UPLOADING&&P?.isActive&&e(H)){const p=setTimeout(()=>{console.log("Automation: Triggering upload via UploaderOrchestrator"),e(H)?.startUpload()},200);return()=>clearTimeout(p)}});const B=be(()=>e(d)===_.READY||e(d)===_.READY_WARNING),ue=be(()=>e(C).filter(p=>!p.isDeleted));Re(()=>{if(e(d)===_.UPLOADING&&e(C).length>0){const p=e(C).every(v=>v.status===pt.COMPLETED||v.isDeleted),f=e(C).some(v=>!v.isDeleted);if(p&&f){const S=!e(C).some(R=>!R.isDeleted&&R.status===pt.FAILED);t.guidedState.setZipStatus(t.zipFile,S?oe.COMPLETED:oe.ERROR),ge(S)}}});var Pe={hasIssues:ae,getIssueDetails:fe,isReady:he,startUpload:we},Ce=di(),Ge=r(Ce),je=r(Ge);a(Ge);var Ze=l(Ge,2);{var Je=p=>{var f=Xs(),v=l(r(f),2),S=r(v,!0);a(v);var R=l(v,2);{var N=I=>{var n=Ks(),g=r(n);a(n),W(()=>x(g,`Processing: ${e(z)??""}`)),h(I,n)};D(R,I=>{e(z)&&I(N)})}a(f),W(()=>x(S,e(d)===_.LOADING?"Loading manga folder...":e(d)===_.EXTRACTING?"Extracting zip files...":e(d)===_.SERIES_LOOKUP?"Looking up series ID...":e(d)===_.APPLYING_REGEX?"Applying regex patterns...":e(d)===_.CHAPTER_LOOKUP?"Loading chapter dump...":e(d)===_.LOADING_GROUPS?"Loading groups...":e(d)===_.APPLYING_GROUPS?"Applying groups to chapters...":"Applying titles to chapters...")),h(p,f)},Qe=p=>{var f=Me(),v=De(f);{var S=N=>{var I=ui(),n=r(I),g=r(n),o=r(g);a(g),a(n);var u=l(n,2),m=l(r(u),2);Qt(m,{});var G=l(m,2);es(G,{});var A=l(G,2);ts(A,{}),a(u);var O=l(u,2);{var $=me=>{var pe=ii(),Ae=r(pe);{var Le=Y=>{var J=$s();h(Y,J)},Ye=Y=>{var J=Js();h(Y,J)};D(Ae,Y=>{s.seriesId?Y(Ye,!1):Y(Le)})}var Ve=l(Ae,2),rt=r(Ve);{var nt=Y=>{var J=Qs(),Oe=r(J);a(J),W(()=>x(Oe,`‚Ä¢ ${e(M).length??""} duplicate chapter${e(M).length===1?"":"s"} detected`)),h(Y,J)};D(rt,Y=>{e(M).length>0&&Y(nt)})}var qe=l(rt,2);{var ot=Y=>{var J=ei();h(Y,J)};D(qe,Y=>{e(K)&&e(y).length===0&&e(Z)===0&&Y(ot)})}var _e=l(qe,2);{var ct=Y=>{var J=ti(),Oe=r(J);a(J),W(dt=>x(Oe,`‚Ä¢ ${e(y).length??""} group${e(y).length===1?"":"s"} failed to lookup: ${dt??""}`),[()=>e(y).join(", ")]),h(Y,J)};D(_e,Y=>{e(y).length>0&&Y(ct)})}var Be=l(_e,2);{var tt=Y=>{var J=si(),Oe=r(J);a(J),W(()=>x(Oe,`‚Ä¢ ${e(Z)??""} chapter title${e(Z)===1?"":"s"} failed
								to resolve`)),h(Y,J)};D(Be,Y=>{e(Z)>0&&Y(tt)})}a(Ve),a(pe),h(me,pe)};D(O,me=>{e(d)===_.READY_WARNING&&me($)})}var L=l(O,2);{var re=me=>{var pe=li(),Ae=r(pe),Le=r(Ae),Ye=r(Le),Ve=r(Ye);a(Ye),Rt(2),a(Le);var rt=l(Le,2);rt.__click=()=>{for(const{chapter:qe}of e(M))qe.isDeleted=!0},a(Ae);var nt=l(Ae,2);Ue(nt,21,()=>e(M),We,(qe,ot)=>{let _e=()=>e(ot).chapter,ct=()=>e(ot).existingGroups;var Be=oi(),tt=r(Be),Y=r(tt),J=r(Y),Oe=r(J);a(J);var dt=l(J,2);{var Nt=Se=>{var it=ai();h(Se,it)};D(dt,Se=>{_e().isDeleted&&Se(Nt)})}a(Y);var ht=l(Y,2),xt=r(ht);a(ht),a(tt);var st=l(tt,2);st.__click=()=>{_e().isDeleted=!_e().isDeleted};var St=r(st);{var yt=Se=>{var it=ri();h(Se,it)},At=Se=>{var it=ni();h(Se,it)};D(St,Se=>{_e().isDeleted?Se(yt):Se(At,!1)})}a(st),a(Be),W(Se=>{Ee(Be,1,`uno-ecxsrr ${_e().isDeleted?"uno-1ya9ju":""}`),x(Oe,`Vol. ${_e().chapterVolume??"N/A"??""} Ch. ${_e().chapterNumber??"N/A"??""} - ${(_e().chapterTitle||_e().originalFolderPath||"Untitled")??""}`),x(xt,`Existing groups: ${Se??""}`),Ee(st,1,`uno-v1bdur ${_e().isDeleted?"uno-uigj71":"uno-8ta9ap"}`),gt(st,"title",_e().isDeleted?"Restore chapter":"Mark as removed")},[()=>ct().join(", ")]),h(qe,Be)}),a(nt),a(pe),W(()=>x(Ve,`‚ö†Ô∏è Warning: ${e(M).length??""} duplicate chapter${e(M).length===1?"":"s"} detected`)),h(me,pe)};D(L,me=>{e(M).length>0&&me(re)})}var ne=l(L,2),Ie=l(r(ne),2);Ue(Ie,21,()=>e(C),We,(me,pe,Ae)=>{Bs(me,{index:Ae,get chapter(){return e(pe)}})}),a(Ie),a(ne);var xe=l(ne,2);xe.__click=we;var et=r(xe);a(xe),a(I),W(()=>{x(o,`Found ${e(C).length??""} chapter${e(C).length===1?"":"s"} from deepest folders`),xe.disabled=!e(B)||!s.seriesId||e(ue).length===0,x(et,`Start Upload (${e(ue).length??""} of ${e(C).length??""} chapters)`)}),h(N,I)},R=N=>{var I=Me(),n=De(I);{var g=u=>{at(ss(u,{onDone:ge,get busy(){return e(k)},set busy(m){c(k,m,!0)}}),m=>c(H,m,!0),()=>e(H))},o=u=>{var m=Me(),G=De(m);{var A=O=>{var $=ci();h(O,$)};D(G,O=>{e(d)===_.COMPLETED&&O(A)},!0)}h(u,m)};D(n,u=>{e(d)===_.UPLOADING?u(g):u(o,!1)},!0)}h(N,I)};D(v,N=>{e(d)===_.READY||e(d)===_.READY_WARNING?N(S):N(R,!1)},!0)}h(p,f)};D(Ze,p=>{e(d)===_.LOADING||e(d)===_.EXTRACTING||e(d)===_.SERIES_LOOKUP||e(d)===_.APPLYING_REGEX||e(d)===_.CHAPTER_LOOKUP||e(d)===_.LOADING_GROUPS||e(d)===_.APPLYING_GROUPS||e(d)===_.APPLYING_TITLES?p(Je):p(Qe,!1)})}return a(Ce),W(()=>{Ee(Ce,1,`uno-hemz07 ${i()??""}`),x(je,`Processing: ${t.zipFile.name??""}`)}),h(E,Ce),Xe(Pe)}$e(["click"]);var vi=w('<div class="uno-j48514"><p class="uno-5v04yw">No zip file selected. Use the tabs above to select a zip file to process.</p></div>'),gi=w('<div class="uno-eeu1av"><!> <!></div>'),fi=w('<div class="uno-pb4e2u"><div class="uno-k0pcvl"><h1 class="uno-kryzyj">Guided Zip Manga Uploader</h1> <div class="uno-skt2gn"><button type="button" class="uno-q7l7gr">Simple Mode</button> <!></div></div> <a target="_blank" class="uno-6zhxse">Tutorial & Docs</a> <!> <!></div>');function Ai(E,t){Ke(t,!0);const i=new us,s=new cs;lt(ds,i),lt(ft,s),lt(It,new rs);let b=T(null),P=T(null);function d(){i.workflowStep=ke.SELECTING_MANGA_FOLDERS}function Q(){if(i.workflowStep=ke.PROCESSING_MANGA,i.selectedZipFiles.length>0){const F=i.selectedZipFiles[0],j=i.zipFiles.findIndex(te=>te.file===F);j>=0&&(i.currentZipIndex=j,c(b,F,!0))}}function C(F){c(b,F,!0)}function k(F){const j=i.currentZip;if(j&&(F==="success"?i.setZipStatus(j.file,oe.COMPLETED):F==="warning"?i.setZipStatus(j.file,oe.WARNING):F==="error"&&i.setZipStatus(j.file,oe.ERROR)),i.moveToNextZip()){const te=i.currentZip;te&&c(b,te.file,!0)}else c(b,null)}function z(){e(P)&&e(P).startUpload()}const H=be(()=>i.workflowStep!==ke.PROCESSING_MANGA);var se=fi(),M=r(se),K=l(r(M),2),y=r(K);y.__click=()=>os(_t("/"));var Z=l(y,2);is(Z,{}),a(K),a(M);var ee=l(M,2),U=l(ee,2);{var V=F=>{as(F,{})};D(U,F=>{e(H)&&F(V)})}var ie=l(U,2);{var X=F=>{fs(F,{get guidedState(){return i},onDone:d,class:"uno-zgouyr"})},q=F=>{var j=Me(),te=De(j);{var ye=le=>{bs(le,{get guidedState(){return i},onDone:Q,class:"uno-l0uum8"})},ve=le=>{var Ne=Me(),de=De(Ne);{var ce=ge=>{var ae=gi(),fe=r(ae);Ds(fe,{get guidedState(){return i},onZipSelected:C,onAutomationRequestUpload:z,get mangaProcessorRef(){return e(P)},class:"uno-wgeun8"});var he=l(fe,2);{var Fe=B=>{at(pi(B,{get guidedState(){return i},get zipFile(){return e(b)},onProcessingComplete:k,class:"uno-wgeun8"}),ue=>c(P,ue,!0),()=>e(P))},we=B=>{var ue=vi();h(B,ue)};D(he,B=>{e(b)?B(Fe):B(we,!1)})}a(ae),h(ge,ae)};D(de,ge=>{i.workflowStep===ke.PROCESSING_MANGA&&ge(ce)},!0)}h(le,Ne)};D(te,le=>{i.workflowStep===ke.SELECTING_MANGA_FOLDERS?le(ye):le(ve,!1)},!0)}h(F,j)};D(ie,F=>{i.workflowStep===ke.SELECTING_ROOT_FOLDER?F(X):F(q,!1)})}a(se),W(F=>gt(ee,"href",F),[()=>_t("/docs")]),h(E,se),Xe()}$e(["click"]);export{Ai as component,yi as universal};
