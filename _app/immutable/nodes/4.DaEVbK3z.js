import{f as w,a as h,c as Me}from"../chunks/CdXyPVf1.js";import{z as Et,A as D,B as e,C as u,D as ze,E as He,I as r,K as o,J as i,G as W,H as Ke,aH as be,aI as Ft,aJ as ut,u as Re,F as De,aC as lt,af as Rt}from"../chunks/CIcfCS9e.js";import{d as Xe}from"../chunks/CMrQpYvR.js";import{p as Te,b as it,i as G}from"../chunks/Bp05Fg2P.js";import{r as Pt,a as Gt,s as ft}from"../chunks/DVberjZs.js";import{s as N}from"../chunks/BR9ubxrB.js";import{S as vt,s as Ee,e as Ue,i as We,D as Dt,c as Tt,g as Ct,a as Zt,t as wt,T as Lt,b as Ot,d as kt,C as at,p as zt,f as Mt,h as Ut,j as Wt,k as jt,l as Yt,m as Vt,n as qt,o as mt,q as Bt,r as pt,u as Ht,v as Kt,w as Xt,Z as $t,B as Jt,x as Qt,y as es,z as ts,U as ss,A as as,E as is}from"../chunks/DncVjSoK.js";import{b as xt,A as rs}from"../chunks/LF6JFb3L.js";import{a as ns,r as _t}from"../chunks/CJWsY6Ih.js";import{g as os}from"../chunks/BSUMDr5Y.js";const ls=!0,Aa=Object.freeze(Object.defineProperty({__proto__:null,prerender:ls},Symbol.toStringTag,{value:"Module"}));var ke=(b=>(b.SELECTING_ROOT_FOLDER="SELECTING_ROOT_FOLDER",b.SELECTING_MANGA_FOLDERS="SELECTING_MANGA_FOLDERS",b.PROCESSING_MANGA="PROCESSING_MANGA",b))(ke||{}),oe=(b=>(b.PENDING="PENDING",b.PROCESSING="PROCESSING",b.COMPLETED="COMPLETED",b.ERROR="ERROR",b.WARNING="WARNING",b))(oe||{}),m=(b=>(b.LOADING="LOADING",b.EXTRACTING="EXTRACTING",b.SERIES_LOOKUP="SERIES_LOOKUP",b.APPLYING_REGEX="APPLYING_REGEX",b.CHAPTER_LOOKUP="CHAPTER_LOOKUP",b.LOADING_GROUPS="LOADING_GROUPS",b.APPLYING_GROUPS="APPLYING_GROUPS",b.APPLYING_TITLES="APPLYING_TITLES",b.READY="READY",b.READY_WARNING="READY_WARNING",b.UPLOADING="UPLOADING",b.COMPLETED="COMPLETED",b))(m||{});class us{#e=D(null);get rootFolderFiles(){return e(this.#e)}set rootFolderFiles(t){u(this.#e,t,!0)}#t=D(ze([]));get zipFiles(){return e(this.#t)}set zipFiles(t){u(this.#t,t,!0)}#s=D(ze([]));get selectedZipFiles(){return e(this.#s)}set selectedZipFiles(t){u(this.#s,t,!0)}#a=D(-1);get currentZipIndex(){return e(this.#a)}set currentZipIndex(t){u(this.#a,t,!0)}#i=D("SELECTING_ROOT_FOLDER");get workflowStep(){return e(this.#i)}set workflowStep(t){u(this.#i,t,!0)}get currentZip(){return this.currentZipIndex<0||this.currentZipIndex>=this.zipFiles.length?null:this.zipFiles[this.currentZipIndex]}get unprocessedZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status!=="COMPLETED")}get pendingZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="PENDING")}get warningZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="WARNING")}get errorZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="ERROR")}get completedZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="COMPLETED")}get processingZips(){return this.zipFiles.filter(t=>this.selectedZipFiles.includes(t.file)&&t.status==="PROCESSING")}get nextZip(){const t=this.pendingZips;if(t.length===0)return null;const a=this.currentZip,s=a?t.filter(_=>_.file!==a.file):t;return s.length===0?null:s[0]}setZipStatus(t,a){const s=this.zipFiles.find(_=>_.file===t);s&&(s.status=a)}moveToNextZip(){const t=this.nextZip;if(!t)return!1;const a=this.zipFiles.findIndex(s=>s.file===t.file);return a>=0?(this.currentZipIndex=a,!0):!1}get zipFilesByMangaFolder(){const t=new vt;for(const a of this.zipFiles)t.has(a.mangaFolderName)||t.set(a.mangaFolderName,[]),t.get(a.mangaFolderName).push(a);return t}reset(){this.rootFolderFiles=null,this.zipFiles=[],this.selectedZipFiles=[],this.currentZipIndex=-1,this.workflowStep="SELECTING_ROOT_FOLDER"}}class cs{#e=D(!1);get enabled(){return e(this.#e)}set enabled(t){u(this.#e,t,!0)}get isActive(){return this.enabled}enable(){this.enabled=!0}disable(){this.enabled=!1}reset(){this.enabled=!1}}const ds=Et(),gt=Et();var ps=w('<div class="uno-4maolu"><div class="uno-senp7v"></div> <p class="uno-l6h9uf">Scanning folder structure...</p></div>'),vs=w('<div class="uno-laclbo"><p class="uno-dl0t86"> </p></div>'),fs=w('<div class="uno-tm086o"><button><h1 class="uno-brv6u2">Select Root Folder</h1> <p class="uno-l6h9uf">Select the folder containing manga subfolders with .zip files</p> <input class="uno-qya2ty" type="file"/></button> <!> <!></div>');function gs(b,t){He(t,!0);let a=Te(t,"guidedState",7),s=Te(t,"class",3,""),_=D(null),R=D(!1);async function d(A){u(R,!0);const C=A.target,ee=Array.from(C.files??[]),U=[];for(const V of ee){const X=(V.webkitRelativePath||V.name).split("/").filter(Boolean);if(X.length>=2){const q=X[0],F=X[0],j=V.name.split(".").pop()?.toLowerCase();(j==="zip"||j==="cbz")&&U.push({file:V,mangaFolderName:q,mangaFolderPath:F})}}a().rootFolderFiles=ee,a().zipFiles=U.map(V=>({...V,status:oe.PENDING})),u(R,!1),t.onDone()}function Q(A){e(_)?.click()}var T=fs(),k=r(T);k.__click=Q;var z=o(r(k),4);z.webkitdirectory=!0,z.multiple=!0,z.__change=d,it(z,A=>u(_,A),()=>e(_)),i(k);var H=o(k,2);{var se=A=>{var C=ps();h(A,C)};G(H,A=>{e(R)&&A(se)})}var M=o(H,2);{var K=A=>{var C=vs(),ee=r(C),U=r(ee);i(ee),i(C),W(()=>N(U,`Found ${a().zipFiles.length??""} zip file${a().zipFiles.length===1?"":"s"}`)),h(A,C)};G(M,A=>{a().zipFiles.length>0&&A(K)})}i(T),W(()=>{Ee(k,1,`uno-a4tqjo ${s()??""}`),k.disabled=e(R)}),h(b,T),Ke()}Xe(["click","change"]);var hs=w('<button type="button"><div class="uno-bpywdh"><p class="uno-98yf80"> </p> <p class="uno-42pivu"> </p></div> <input type="checkbox" class="uno-5onsv4"/></button>'),ms=w('<div class="uno-o40niy"><div class="uno-iuhcpm"><h3 class="uno-0lb4rh"> </h3> <button type="button" class="uno-phh4jd"> </button></div> <div class="uno-fb55wk"></div></div>'),_s=w('<div><div class="uno-iuhcpm"><h2 class="uno-iyer7g">Select Zip Files to Process</h2> <button type="button" class="uno-f45w65"> </button></div> <p class="uno-ok9xip"> </p> <div class="uno-yjimjk"></div> <button type="button" class="uno-3s4o5e"> </button></div>');function bs(b,t){He(t,!0);let a=Te(t,"guidedState",7),s=Te(t,"class",3,"");function _(U){a().selectedZipFiles.indexOf(U)>=0?a().selectedZipFiles=a().selectedZipFiles.filter(ae=>ae!==U):a().selectedZipFiles=[...a().selectedZipFiles,U]}function R(U){const V=Array.from(a().zipFilesByMangaFolder.get(U)??[]);if(V.every(X=>a().selectedZipFiles.includes(X.file)))a().selectedZipFiles=a().selectedZipFiles.filter(X=>!V.some(q=>q.file===X));else{const X=V.map(q=>q.file).filter(q=>!a().selectedZipFiles.includes(q));a().selectedZipFiles=[...a().selectedZipFiles,...X]}}function d(){a().selectedZipFiles.length===a().zipFiles.length?a().selectedZipFiles=[]:a().selectedZipFiles=a().zipFiles.map(U=>U.file)}const Q=be(()=>a().zipFiles.length>0&&a().selectedZipFiles.length===a().zipFiles.length),T=be(()=>a().zipFilesByMangaFolder);var k=_s(),z=r(k),H=o(r(z),2);H.__click=d;var se=r(H,!0);i(H),i(z);var M=o(z,2),K=r(M);i(M);var A=o(M,2);Ue(A,21,()=>Array.from(e(T).entries()),We,(U,V)=>{var ae=be(()=>Ft(e(V),2));let X=()=>e(ae)[0],q=()=>e(ae)[1];var F=ms(),j=r(F),te=r(j),Ae=r(te,!0);i(te);var ve=o(te,2);ve.__click=()=>R(X());var le=r(ve);i(ve),i(j);var Ie=o(j,2);Ue(Ie,21,q,We,(de,ce)=>{const fe=be(()=>a().selectedZipFiles.includes(e(ce).file));var ie=hs();ie.__click=()=>_(e(ce).file);var ge=r(ie),he=r(ge),Fe=r(he,!0);i(he);var we=o(he,2),B=r(we);i(we),i(ge);var ue=o(ge,2);Pt(ue),i(ie),W(Pe=>{Ee(ie,1,`uno-ik4adi ${e(fe)?"uno-1k75dk":""}`),N(Fe,e(ce).file.name),N(B,`Size: ${Pe??""} MB`),Gt(ue,e(fe))},[()=>(e(ce).file.size/(1024*1024)).toFixed(2)]),h(de,ie)}),i(Ie),i(F),W(de=>{N(Ae,X()),N(le,`${de??""} (${q().length??""})`)},[()=>q().every(de=>a().selectedZipFiles.includes(de.file))?"Deselect All":"Select All"]),h(U,F)}),i(A);var C=o(A,2);C.__click=function(...U){t.onDone?.apply(this,U)};var ee=r(C);i(C),i(k),W(()=>{Ee(k,1,`uno-grwdkw ${s()??""}`),N(se,e(Q)?"Deselect All":"Select All"),N(K,`${a().selectedZipFiles.length??""} of ${a().zipFiles.length??""} zip file${a().zipFiles.length===1?"":"s"} selected`),C.disabled=a().selectedZipFiles.length===0,N(ee,`Continue to Processing (${a().selectedZipFiles.length??""} selected)`)}),h(b,k),Ke()}Xe(["click"]);var Es=w('<p class="uno-a54tpo"> </p>'),ws=w('<div class="uno-cqccui"><p class="uno-nsysfu"> </p> <span> </span></div> <!>',1),xs=w('<p class="uno-b7m48p">No zip file selected</p>'),Is=w('<button type="button" class="uno-qm31yq"> </button>'),Ns=w('<p class="uno-b7m48p">No more zip files to process</p>'),Ss=w("<div><!></div>"),As=w('<p class="uno-b7m48p">All zip files have been completed</p>'),ys=w('<button type="button" class="uno-4y4l6m"> </button>'),Fs=w('<div class="uno-2db0z0"><h3 class="uno-tniapq"> </h3> <div class="uno-ouywhe"></div></div>'),Rs=w('<button type="button" class="uno-qy4bc0"> </button>'),Ps=w('<div class="uno-2db0z0"><h3 class="uno-9iz2qs"> </h3> <div class="uno-ouywhe"></div></div>'),Gs=w('<div><div class="uno-0ia1w6 border-surface-hover"><h2 class="uno-1c2kr2">Zip Processing</h2> <div class="uno-cqccui"><span class="uno-d1zaof">Automation (experimental): <span> </span></span> <button type="button"> </button></div></div> <div class="uno-usvt4c"><div class="uno-cqccui"><span class="uno-4ezlml"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-1l1bmy"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-e545zy"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-mg1fk7"></span> <span class="uno-b7m48p"> </span></div> <div class="uno-cqccui"><span class="uno-ip18dj"></span> <span class="uno-b7m48p"> </span></div></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Current Zip File</h3> <!></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Next Zip File</h3> <!></div> <div class="uno-2db0z0"><h3 class="uno-py45hl">Select Zip File</h3> <!></div> <!> <!></div>');function Ds(b,t){He(t,!0);let a=Te(t,"guidedState",7),s=Te(t,"class",3,"");const _=ut(gt);if(!_)throw new Error("MangaProcessingTabs must be used within a component that provides AutomationState context");function R(){if(a().moveToNextZip()){const l=a().currentZip;l&&t.onZipSelected(l.file)}}function d(l){const c=a().zipFiles.find(E=>E.file.name===l);if(c){const E=a().zipFiles.findIndex(Z=>Z.file===c.file);E>=0&&(a().currentZipIndex=E,t.onZipSelected(c.file))}}function Q(){_.enabled?_.disable():_.enable()}const T=be(()=>a().currentZip?.file.name??null),k=be(()=>a().warningZips.map(l=>l.file.name)),z=be(()=>a().errorZips.map(l=>l.file.name)),H=be(()=>a().unprocessedZips.map(l=>l.file.name)),se=be(()=>a().nextZip?.file.name??null),M=be(()=>a().pendingZips.length===0&&(a().warningZips.length>0||a().errorZips.length>0));Re(()=>{e(M)&&_.isActive&&_.disable()});let K=D(null);Re(()=>{u(K,a().currentZip?.file.name??null,!0)}),Re(()=>{const l=e(K);if(l){const c=a().currentZip?.file.name??null;l!==c&&d(l)}});const A=be(()=>({pending:a().pendingZips.length,warning:a().warningZips.length,error:a().errorZips.length,completed:a().completedZips.length,processing:a().processingZips.length}));var C=Gs(),ee=r(C),U=o(r(ee),2),V=r(U),ae=o(r(V)),X=r(ae,!0);i(ae),i(V);var q=o(V,2);q.__click=Q;var F=r(q,!0);i(q),i(U),i(ee);var j=o(ee,2),te=r(j),Ae=o(r(te),2),ve=r(Ae);i(Ae),i(te);var le=o(te,2),Ie=o(r(le),2),de=r(Ie);i(Ie),i(le);var ce=o(le,2),fe=o(r(ce),2),ie=r(fe);i(fe),i(ce);var ge=o(ce,2),he=o(r(ge),2),Fe=r(he);i(he),i(ge);var we=o(ge,2),B=o(r(we),2),ue=r(B);i(B),i(we),i(j);var Pe=o(j,2),Ce=o(r(Pe),2);{var Ge=l=>{var c=ws(),E=De(c),Z=r(E),y=r(Z,!0);i(Z);var O=o(Z,2),$=r(O,!0);i(O),i(E);var L=o(E,2);{var re=ne=>{var xe=Es(),Ne=r(xe);i(xe),W(()=>N(Ne,`Manga Folder: ${a().currentZip.mangaFolderName??""}`)),h(ne,xe)};G(L,ne=>{a().currentZip&&ne(re)})}W(()=>{N(y,e(T)),Ee(O,1,`uno-ielryd ${a().currentZip?.status===oe.PROCESSING?"uno-kxa2ln":a().currentZip?.status===oe.COMPLETED?"uno-b1425w":a().currentZip?.status===oe.ERROR?"uno-isu16c":a().currentZip?.status===oe.WARNING?"uno-enplrj":"uno-jwlzg2"}`),N($,a().currentZip?.status??"UNKNOWN")}),h(l,c)},je=l=>{var c=xs();h(l,c)};G(Ce,l=>{e(T)?l(Ge):l(je,!1)})}i(Pe);var Ze=o(Pe,2),$e=o(r(Ze),2);{var Je=l=>{var c=Is();c.__click=R;var E=r(c);i(c),W(()=>{c.disabled=_.enabled,N(E,`Process: ${e(se)??""}`)}),h(l,c)},p=l=>{var c=Ns();h(l,c)};G($e,l=>{e(se)?l(Je):l(p,!1)})}i(Ze);var g=o(Ze,2),v=o(r(g),2);{var I=l=>{var c=Ss(),E=r(c);Dt(E,{get items(){return e(H)},class:"uno-qbg2l1",get selectedItem(){return e(K)},set selectedItem(Z){u(K,Z,!0)}}),i(c),W(()=>Ee(c,1,Tt(_.enabled?"opacity-50 pointer-events-none":""))),h(l,c)},P=l=>{var c=As();h(l,c)};G(v,l=>{e(H).length>0?l(I):l(P,!1)})}i(g);var S=o(g,2);{var x=l=>{var c=Fs(),E=r(c),Z=r(E);i(E);var y=o(E,2);Ue(y,21,()=>e(k),We,(O,$)=>{var L=ys();L.__click=()=>d(e($));var re=r(L,!0);i(L),W(()=>{L.disabled=_.enabled,N(re,e($))}),h(O,L)}),i(y),i(c),W(()=>N(Z,`‚ö†Ô∏è Warning Zips (${e(k).length??""})`)),h(l,c)};G(S,l=>{e(k).length>0&&l(x)})}var n=o(S,2);{var f=l=>{var c=Ps(),E=r(c),Z=r(E);i(E);var y=o(E,2);Ue(y,21,()=>e(z),We,(O,$)=>{var L=Rs();L.__click=()=>d(e($));var re=r(L,!0);i(L),W(()=>{L.disabled=_.enabled,N(re,e($))}),h(O,L)}),i(y),i(c),W(()=>N(Z,`‚ùå Error Zips (${e(z).length??""})`)),h(l,c)};G(n,l=>{e(z).length>0&&l(f)})}i(C),W(()=>{Ee(C,1,`uno-s0eao9 ${s()??""}`),Ee(ae,1,`uno-cvk0wv ${_.enabled?"uno-ikj4sb":"uno-je1lgh"}`),N(X,_.enabled?"ON":"OFF"),Ee(q,1,`uno-sv39f1 ${_.enabled?"uno-oxxvv6":"uno-dimr5c"}`),N(F,_.enabled?"üîÑ Turn OFF":"‚ñ∂Ô∏è Turn ON"),N(ve,`Pending: ${e(A).pending??""}`),N(de,`Processing: ${e(A).processing??""}`),N(ie,`Warning: ${e(A).warning??""}`),N(Fe,`Error: ${e(A).error??""}`),N(ue,`Completed: ${e(A).completed??""}`)}),h(b,C),Ke()}Xe(["click"]);function Ts(b){const t=Ct(b,0);return Zt(b,t,0,[])}function Cs(b,t="v(\\d+)"){const a=new RegExp(t,"i"),s=b.match(a);return s&&s[1]?s[1].replace(/^0+/,"")||"0":null}function Zs(b,t="c(\\d+(?:\\.\\d+){0,2})"){const a=new RegExp(t,"i"),s=b.match(a);if(s&&s[1]){const _=s[1];if(_.includes(".")){const R=_.split(".");return[R[0].replace(/^0+/,"")||"0",...R.slice(1)].join(".")}else return _.replace(/^0+/,"")||"0"}return null}function Ls(b){const t=/MD-(\d+)/i,a=b.match(t);return a?a[1]:null}var Os=w('<span class="uno-lzl9l3 svelte-m4i47p">Removed</span>'),ks=w('<button type="button" class="uno-lj049g svelte-m4i47p" title="Edit volume and chapter" aria-label="Edit volume and chapter"><div class="uno-smkhzc svelte-m4i47p"></div></button>'),zs=w('<div class="uno-7qt2lg svelte-m4i47p"><div class="uno-m5mbjf svelte-m4i47p"></div> <span class="svelte-m4i47p">Restore</span></div>'),Ms=w('<div class="uno-7qt2lg svelte-m4i47p"><div class="uno-9z7ooq svelte-m4i47p"></div> <span class="svelte-m4i47p">Remove</span></div>'),Us=w('<span class="uno-2et217 svelte-m4i47p"> </span>'),Ws=w('<div class="uno-58lieu svelte-m4i47p">Loading combinations...</div>'),js=w('<div class="uno-58lieu svelte-m4i47p">No volume/chapter combinations available</div>'),Ys=w('<button type="button"><div class="uno-l6o6ga svelte-m4i47p"><span class="svelte-m4i47p"> </span></div></button>'),Vs=w('<div class="uno-iqadiw svelte-m4i47p" role="presentation"><div class="uno-k7cjbm svelte-m4i47p"><!></div></div>'),qs=w('<div><div class="uno-rzokcw svelte-m4i47p"><div class="uno-n4d6p5 svelte-m4i47p"><span class="uno-upv063 svelte-m4i47p"> </span> <!> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Vol:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Ch:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div> <!> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Pages:</span> <span class="uno-4g5bui svelte-m4i47p"> </span></div></div> <button type="button"><!></button></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Title:</span> <div class="uno-aqzn48 svelte-m4i47p"><!> <!></div></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Groups:</span> <!></div> <div class="uno-0yx623 svelte-m4i47p"><span class="uno-7f6l2t svelte-m4i47p">Path:</span> <span class="uno-nggqeg svelte-m4i47p"> </span></div></div> <!>',1);function Bs(b,t){if(He(t,!0),!ut(wt))throw new Error("GuidedChapterEditor must be used within a component that provides TargetingState context");let s=Te(t,"chapter",7),_=Te(t,"class",3,""),R=D(!1),d=D(ze([])),Q=D(!1),T=D(null),k=D(null),z=D(null),H=D(null);function se(){s().isDeleted=!s().isDeleted}async function M(){if(!e(R)){e(T)&&u(H,e(T).getBoundingClientRect(),!0),u(R,!0),u(Q,!0);try{const n=s().associatedSeries?.seriesId;if(!n){console.warn("No series ID available for chapter"),u(R,!1);return}await at.load(),u(d,await at.getUniqueVolumeChapterCombinations(n),!0)}catch(n){console.error("Failed to load volume/chapter combinations:",n)}finally{u(Q,!1)}}}function K(){u(R,!1),u(z,null),u(H,null)}function A(n){if(n.ungroupedTitles.length>0)return n.ungroupedTitles[0];const f=Object.keys(n.groupTitles);return f.length>0?n.groupTitles[f[0]]:null}function C(n){s().manuallyEditedFields.has("volume")||(s().originalFieldValues.has("volume")||s().originalFieldValues.set("volume",s().chapterVolume),s().manuallyEditedFields.add("volume")),s().manuallyEditedFields.has("chapter")||(s().originalFieldValues.has("chapter")||s().originalFieldValues.set("chapter",s().chapterNumber),s().manuallyEditedFields.add("chapter")),s().manuallyEditedFields.has("title")||(s().originalFieldValues.has("title")||s().originalFieldValues.set("title",s().chapterTitle),s().manuallyEditedFields.add("title")),s().chapterVolume=n.volume||null,s().chapterNumber=n.chapter||null,s().chapterTitle=A(n.info),K()}function ee(n){const f=n.volume||"N/A",l=n.chapter||"N/A",c=A(n.info),E=c?` - ${c}`:"";return`Vol ${f}, Ch ${l}${E}`}function U(){if(!e(H))return;const n=e(H),f=window.innerHeight,l=window.innerWidth,c=4,E=256;let Z=E;if(e(k)){const Qe=e(k).getBoundingClientRect().height;Z=Math.min(Qe,E)}const y=f-n.bottom-c,O=n.top-c,$=y<E&&O>y;let L;$?(L=n.top-Z-c,L<c&&(L=c)):(L=n.bottom+c,L+Z>f&&(L=Math.max(c,f-Z-c)));let re=n.left;const ne=320,xe=Math.min(400,l-c*2),Ne=Math.max(ne,Math.min(xe,n.width));re+Ne>l-c&&(re=l-Ne-c),re<c&&(re=c),u(z,{top:L,left:re,width:Ne},!0)}Re(()=>{if(e(R)){if(!e(H)){u(z,null);return}requestAnimationFrame(()=>{requestAnimationFrame(()=>{U()})});const n=()=>U(),f=c=>{const E=c.target;e(k)&&!e(k).contains(E)&&e(T)&&!e(T).contains(E)&&K()},l=setTimeout(()=>{window.addEventListener("resize",n),document.addEventListener("click",f,!0)},10);return()=>{clearTimeout(l),window.removeEventListener("resize",n),document.removeEventListener("click",f,!0)}}else u(z,null)}),Re(()=>{e(R)&&e(k)&&requestAnimationFrame(()=>{U()})});var V=qs(),ae=De(V),X=r(ae),q=r(X),F=r(q),j=r(F);i(F);var te=o(F,2);{var Ae=n=>{var f=Os();h(n,f)};G(te,n=>{s().isDeleted&&n(Ae)})}var ve=o(te,2),le=o(r(ve),2),Ie=r(le,!0);i(le),i(ve);var de=o(ve,2),ce=o(r(de),2),fe=r(ce,!0);i(ce),i(de);var ie=o(de,2);{var ge=n=>{var f=ks();f.__click=l=>{l.stopPropagation(),M()},it(f,l=>u(T,l),()=>e(T)),h(n,f)};G(ie,n=>{s().associatedSeries?.seriesId&&n(ge)})}var he=o(ie,2),Fe=o(r(he),2),we=r(Fe,!0);i(Fe),i(he),i(q);var B=o(q,2);B.__click=se;var ue=r(B);{var Pe=n=>{var f=zs();h(n,f)},Ce=n=>{var f=Ms();h(n,f)};G(ue,n=>{s().isDeleted?n(Pe):n(Ce,!1)})}i(B),i(X);var Ge=o(X,2),je=o(r(Ge),2),Ze=r(je);Lt(Ze,{textClass:"text-sm text-app font-medium",fieldName:"title",get chapter(){return s()},get value(){return s().chapterTitle},set value(n){s().chapterTitle=n}});var $e=o(Ze,2);{var Je=n=>{var f=Us(),l=r(f);i(f),W(()=>N(l,`(${(s().originalFolderPath||"Untitled")??""})`)),h(n,f)};G($e,n=>{s().chapterTitle||n(Je)})}i(je),i(Ge);var p=o(Ge,2),g=o(r(p),2);Ot(g,{fieldName:"groups",get chapter(){return s()},get groups(){return s().associatedGroup},set groups(n){s().associatedGroup=n}}),i(p);var v=o(p,2),I=o(r(v),2),P=r(I,!0);i(I),i(v),i(ae);var S=o(ae,2);{var x=n=>{var f=Vs();f.__click=y=>y.stopPropagation();var l=r(f),c=r(l);{var E=y=>{var O=Ws();h(y,O)},Z=y=>{var O=Me(),$=De(O);{var L=ne=>{var xe=js();h(ne,xe)},re=ne=>{var xe=Me(),Ne=De(xe);Ue(Ne,17,()=>e(d),We,(Qe,me)=>{var pe=Ys();pe.__click=()=>C(e(me));var ye=r(pe),Le=r(ye),Ye=r(Le,!0);i(Le),i(ye),i(pe),W(Ve=>{Ee(pe,1,`uno-ss9yjz ${s().chapterVolume===e(me).volume&&s().chapterNumber===e(me).chapter?"uno-eokg3r":""}`,"svelte-m4i47p"),N(Ye,Ve)},[()=>ee(e(me))]),h(Qe,pe)}),h(ne,xe)};G($,ne=>{e(d).length===0?ne(L):ne(re,!1)},!0)}h(y,O)};G(c,y=>{e(Q)?y(E):y(Z,!1)})}i(l),i(f),it(f,y=>u(k,y),()=>e(k)),W(()=>kt(f,`top: ${e(z).top??""}px; left: ${e(z).left??""}px; width: ${e(z).width??""}px;`)),h(n,f)};G(S,n=>{e(R)&&e(z)&&n(x)})}W(()=>{Ee(ae,1,`uno-3rf4hu ${s().isDeleted?"uno-d3zfvr":""} ${_()??""}`,"svelte-m4i47p"),N(j,`#${t.index+1}`),N(Ie,s().chapterVolume??"N/A"),N(fe,s().chapterNumber??"N/A"),N(we,s().pages.length),Ee(B,1,`uno-lto8ne ${s().isDeleted?"uno-ld06wt":"uno-far8pd"}`,"svelte-m4i47p"),ft(B,"title",s().isDeleted?"Restore chapter":"Mark as removed"),N(P,s().originalFolderPath)}),h(b,V),Ke()}Xe(["click"]);class Hs{#e=D(null);get legacyToWeebdexMap(){return e(this.#e)}set legacyToWeebdexMap(t){u(this.#e,t,!0)}#t=D(null);get weebdexToLegacyMap(){return e(this.#t)}set weebdexToLegacyMap(t){u(this.#t,t,!0)}#s=D(!1);get isLoading(){return e(this.#s)}set isLoading(t){u(this.#s,t,!0)}#a=D(null);get loadError(){return e(this.#a)}set loadError(t){u(this.#a,t,!0)}loadPromise=null;async load(){if(this.legacyToWeebdexMap!==null&&this.weebdexToLegacyMap!==null)return;if(this.loadPromise)return this.loadPromise;this.isLoading=!0,this.loadError=null;let t,a;this.loadPromise=new Promise((s,_)=>{t=s,a=_});try{const s=ns("/weebdex_lookup.csv"),_=await fetch(s);if(!_.ok)throw new Error(`Failed to fetch CSV: ${_.status} ${_.statusText}`);const R=await _.text(),{legacyToWeebdex:d,weebdexToLegacy:Q}=this.parseCSV(R);this.legacyToWeebdexMap=d,this.weebdexToLegacyMap=Q,t()}catch(s){this.loadError=s instanceof Error?s:new Error("Unknown error loading CSV"),a(this.loadError)}finally{this.isLoading=!1}return this.loadPromise}async ensureLoaded(){if(!(this.legacyToWeebdexMap!==null&&this.weebdexToLegacyMap!==null)){if(this.loadPromise){await this.loadPromise;return}await this.load()}}parseCSV(t){const a=zt(t,{columns:!0,skip_empty_lines:!0,trim:!0}),s=new vt,_=new vt;for(const R of a){const d=R.weebdex_id?.trim()||"",Q=R.legacy_id?.trim()||"";d&&Q&&(s.set(Q,d),_.set(d,Q))}return{legacyToWeebdex:s,weebdexToLegacy:_}}async getWeebdexIdFromLegacyId(t){return await this.ensureLoaded(),this.legacyToWeebdexMap===null?null:this.legacyToWeebdexMap.get(t)||null}}const bt=new Hs;var Ks=w('<p class="uno-8520et"> </p>'),Xs=w('<div class="uno-vsugad"><div class="uno-pj4440"></div> <p class="uno-hw2z5w"> </p> <!></div>'),$s=w(`<p class="uno-stwt3u">‚ö†Ô∏è Waiting for series ID - Automation will skip this zip. Please select a series
							above.</p>`),Js=w('<p class="uno-stwt3u">‚ö†Ô∏è Ready with warnings - Automation will skip this zip. You can still upload manually.</p>'),Qs=w("<p> </p>"),ea=w("<p>‚Ä¢ Chapter dump lookup failed</p>"),ta=w("<p> </p>"),sa=w("<p> </p>"),aa=w('<div class="uno-hqujre"><!> <div class="uno-4ixn7j"><!> <!> <!> <!></div></div>'),ia=w('<span class="uno-czmb1a">Removed</span>'),ra=w('<div class="uno-2umhxz"></div>'),na=w('<div class="uno-kp2ftc"></div>'),oa=w('<div><div class="uno-py2y93"><div class="uno-nxlaaf"><p class="uno-39vbxq"> </p> <!></div> <p class="uno-dsgwse"> </p></div> <button type="button"><!></button></div>'),la=w(`<div class="uno-bi16xf"><div class="uno-nnnwwl"><div class="uno-djaa0e"><p class="uno-apr5a0"> </p> <p class="uno-lp9tww">The following chapters already exist on WeebDex with matching groups. You can mark
								them as removed to skip uploading.</p></div> <button type="button" class="uno-3jkjwc" title="Mark all duplicate chapters as removed">Removed duplicate chapters</button></div> <div class="uno-56cpuz"></div></div>`),ua=w('<div class="uno-hemz07"><div class="uno-ns83sq"><p class="uno-0zsd1s"> </p></div> <div class="uno-f2o4wl"><h3 class="uno-otxjpc">Series Selection (Required)</h3> <!> <!> <!></div> <!> <!> <div class="uno-f2o4wl"><h3 class="uno-otxjpc">Detected Chapters</h3> <div class="uno-xqlxhl"></div></div> <button type="button" class="uno-d93lfx"> </button></div>'),ca=w('<div class="uno-6nb6x4"><p class="uno-dillda">‚úì Upload completed successfully!</p></div>'),da=w('<div><h2 class="uno-67n1yz"> </h2> <!></div>');function pa(b,t){He(t,!0),Mt({useWebWorkers:!1});let a=Te(t,"class",3,"");const s=new Ut;lt(wt,s);const _=ut(xt);if(!_)throw new Error("MangaProcessor must be used within a component that provides ApiAuthContext");const R=ut(gt);let d=D(ze(m.LOADING)),Q=D(null),T=D(ze([])),k=D(!1),z=D(null),H=D(null),se=D(null),M=D(ze([])),K=D(!1),A=D(ze([])),C=D(0),ee=D(null);const U=["jpg","jpeg","png","gif","webp","cbz","zip","xml"];Re(()=>{t.zipFile&&(u(se,null),u(M,[],!0),u(K,!1),u(A,[],!0),u(C,0),u(ee,null),V())});async function V(){try{if(await q(),await F(),!s.seriesId){u(d,m.READY_WARNING,!0);return}u(d,m.APPLYING_REGEX,!0),await j(),await te(),await Ae(),await ve(),await ce(),ie()?u(d,m.READY_WARNING,!0):u(d,m.READY,!0)}catch(p){console.error("Error in processing pipeline:",p),u(ee,p instanceof Error?p.message:"Processing failed",!0),t.guidedState.setZipStatus(t.zipFile,oe.ERROR),u(d,m.READY_WARNING,!0),t.onProcessingComplete("error")}}async function ae(p){const g=p.name.split(".").pop()?.toLowerCase();if(!(g==="cbz")&&!(g==="zip"))throw new Error(`Unsupported archive format: ${g}`);console.log(`Extracting ${g} file:`,p.name),u(z,p.name,!0);const P=new $t(new Jt(p)),S=await P.getEntries(),x=[],n=p.name.replace(/\.(cbz|zip)$/i,""),f=p.webkitRelativePath||p.name;for(const l of S){if(!l.filename||l.directory)continue;const c=l.filename.split(".").pop()?.toLowerCase();if(!c||!U.includes(c))continue;const E=new TransformStream,Z=new Response(E.readable).blob();await l.getData(E.writable);let y=await Z;if(!y.type){const ne=X(c);y=new Blob([y],{type:ne})}const O=l.filename,$=O.split("/").pop()??O,L=f.includes("/")?`${f.split("/").slice(0,-1).join("/")}/${n}/${O}`:`${n}/${O}`,re=new File([y],$,{type:y.type});Object.defineProperty(re,"webkitRelativePath",{value:L,writable:!1,enumerable:!0,configurable:!0}),x.push(re)}return await P.close(),u(z,null),x}function X(p){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp"}[p]||"application/octet-stream"}async function q(){u(d,m.LOADING,!0),s.reset(),u(d,m.EXTRACTING,!0);let p=[];try{p=await ae(t.zipFile)}catch(v){throw console.error(`Error extracting ${t.zipFile.name}:`,v),u(ee,v instanceof Error?v.message:"Failed to extract archive",!0),v}u(Q,Wt(p),!0);const g=Ts(e(Q));u(T,await Promise.all(g.map(async v=>{const I=Cs(v.name),P=Zs(v.name),S=v.files.filter(x=>x.type===jt.CHAPTER_PAGE).map((x,n)=>new Yt(x.file.name,n,x.file,Vt.NOT_STARTED,0,null,null,!1,x.type));return new qt(v.path,v.name,I,P,new mt,new Bt,S,pt.NOT_STARTED,0,null,null,v,!1,"en")})),!0),e(T).sort((v,I)=>{if(v.chapterVolume&&I.chapterVolume){const P=String(v.chapterVolume).localeCompare(String(I.chapterVolume),void 0,{numeric:!0,sensitivity:"base"});if(P!==0)return P}else{if(v.chapterVolume)return-1;if(I.chapterVolume)return 1}return v.chapterNumber&&I.chapterNumber?String(v.chapterNumber).localeCompare(String(I.chapterNumber),void 0,{numeric:!0,sensitivity:"base"}):v.chapterNumber?-1:I.chapterNumber?1:0}),s.chapterStates=e(T)}async function F(){u(d,m.SERIES_LOOKUP,!0);const p=Ls(t.zipFile.name);if(p)try{await bt.load();const g=await bt.getWeebdexIdFromLegacyId(p);g?(s.seriesId=g,console.log(`Auto-detected series ID from MD-####: ${p} -> ${g}`)):console.log(`No WeebDex ID found for MangaDex ID: ${p}`)}catch(g){console.warn(`Failed to lookup WeebDex ID for MangaDex ID ${p}:`,g)}s.seriesId&&s.chapterStates.forEach(g=>{g.associatedSeries||(g.associatedSeries=new mt),g.associatedSeries.seriesId=s.seriesId??""})}async function j(){u(d,m.CHAPTER_LOOKUP,!0),s.seriesId&&await at.load()}async function te(){if(u(d,m.LOADING_GROUPS,!0),!s.seriesId)return;const p=await at.getAllGroupNames(s.seriesId);if(p.length===0){console.warn("No groups found in chapter dump"),u(K,!0);return}const g=[],v=[];for(const I of p)try{const P=await Ht(I);if(P.data){const S=P.data.find(x=>x.name===I);if(S){const x=new Kt;x.groupId=S.id,x.groupName=S.name,g.push(x)}else v.push(I)}else v.push(I)}catch(P){console.warn(`Failed to lookup group "${I}":`,P),v.push(I)}u(A,v,!0),v.length>0&&u(K,!0),s.availableScanGroups=g}async function Ae(){u(d,m.APPLYING_GROUPS,!0),await Ie()}async function ve(){if(u(d,m.APPLYING_TITLES,!0),!s.seriesId)return;const p=await de();u(C,p,!0),p>0&&u(K,!0)}Re(()=>{s.seriesId&&(e(d)===m.READY||e(d)===m.READY_WARNING)&&s.seriesId!==e(se)&&(u(se,s.seriesId,!0),le())});async function le(){try{if(await F(),!s.seriesId)return;u(d,m.APPLYING_REGEX,!0),await j(),await te(),await Ae(),await ve(),await ce(),ie()?u(d,m.READY_WARNING,!0):u(d,m.READY,!0)}catch(p){console.error("Error in processing pipeline:",p),u(d,m.READY_WARNING,!0)}}async function Ie(){for(const p of s.chapterStates){if(!p.originalFolderPath)continue;const g=s.availableScanGroups.filter(v=>p.originalFolderPath?.includes(v.groupName)??!1);if(g.length>0){const v=p.associatedGroup.groupIds??[],I=new Set(v);for(const P of g)I.has(P.groupId)||I.add(P.groupId);p.associatedGroup.groupIds=Array.from(I)}}}async function de(){if(!s.seriesId)return 0;const p=new Map;for(const v of s.availableScanGroups)p.set(v.groupId,v.groupName);let g=0;for(const v of s.chapterStates){const I=v.originalFolderPath?.includes("[no group]")??!1,P=v.associatedGroup.groupIds??[];if(P.length===0&&!I){g++;continue}const S=P.map(f=>p.get(f)).filter(f=>f!==void 0);if(S.length===0&&!I){g++;continue}const x=await at.getChapterInfo(s.seriesId,v.chapterVolume,v.chapterNumber);if(!x){g++;continue}let n=null;for(const f of S)if(f in x.groupTitles){n=x.groupTitles[f];break}n===null&&I&&x.ungroupedTitles.length>0&&(n=x.ungroupedTitles[0]),n!==null?v.chapterTitle=n:g++}return g}async function ce(){if(s.seriesId)try{const p=await Xt(s.seriesId),g=[],v=new Map;for(const S of p.chapters){const x=S.volume||"none",n=S.chapter,f=`${x}:${n}`;v.set(f,S)}const I=S=>{const x=new Set;if(p.groups)for(const n of S){const f=p.groups[n];f&&x.add(f.id)}return x},P=(S,x)=>{if(S.size!==x.size)return!1;for(const n of S)if(!x.has(n))return!1;return!0};for(const S of s.chapterStates){const x=S.chapterVolume||"none",n=S.chapterNumber;if(!n)continue;const f=`${x}:${n}`,l=v.get(f);if(l&&l.entries&&Object.keys(l.entries).length>0){const c=new Set(S.associatedGroup.groupIds??[]);if(c.size===0)continue;let E=null;for(const Z of Object.values(l.entries)){const y=I(Z.groups);if(P(c,y)){E=Z;break}}if(E){const Z=I(E.groups),y=[];for(const O of Z){const $=p.groups?.find(L=>L.id===O);$?y.push(`${$.name} (${$.id})`):y.push(`Unknown Group (${O})`)}g.push({chapter:S,existingGroups:y.length>0?y:["Unknown groups"]})}}}u(M,g,!0)}catch(p){console.error("Error checking for duplicates:",p),u(M,[],!0)}}function fe(p){if(e(d)!==m.UPLOADING)return;u(d,m.COMPLETED,!0);const g=p?"success":"error";t.guidedState.setZipStatus(t.zipFile,p?oe.COMPLETED:oe.ERROR),t.onProcessingComplete(g)}function ie(){return e(M).length>0||e(K)||e(A).length>0||e(C)>0}function ge(){return{hasDuplicates:e(M).length>0,duplicateCount:e(M).length,dumpLookupFailed:e(K),failedGroups:e(A).length,failedTitles:e(C)}}function he(){return e(d)===m.READY&&(e(se)===s.seriesId||!s.seriesId)}Re(()=>{if(!R?.isActive)return;const g=e(d),v=s.seriesId,I=e(se),P=g===m.READY||g===m.READY_WARNING;if(!P)return;console.log("Automation: Effect triggered, checking state",{step:g,seriesId:v,lastSeriesId:I,shouldCheck:P});const S=setTimeout(()=>{Fe()},500);return()=>clearTimeout(S)});async function Fe(){if(!R?.isActive){console.log("Automation: Not active");return}if(e(d)===m.READY_WARNING){console.log("Automation: READY_WARNING state detected, marking as warning and skipping"),t.guidedState.setZipStatus(t.zipFile,oe.WARNING),t.onProcessingComplete("warning");return}if(!he()){console.log("Automation: Not ready",{step:e(d),seriesId:s.seriesId,lastProcessedSeriesId:e(se)});return}console.log("Automation: Checking zip file",t.zipFile.name);const p=t.guidedState.pendingZips,g=t.guidedState.warningZips.length>0||t.guidedState.errorZips.length>0;if(p.length===0&&g){console.log("Automation: Disabling - only warnings/errors remain"),R.disable();return}console.log("Automation: No issues, starting upload",{canStartUpload:e(B),hasSeriesId:!!s.seriesId,nonDeletedChapters:e(ue).length}),e(B)&&s.seriesId&&e(ue).length>0?we()?console.log("Automation: Upload started successfully"):(console.warn("Automation: Failed to start upload, marking as error"),t.guidedState.setZipStatus(t.zipFile,oe.ERROR),t.onProcessingComplete("error")):(console.warn("Automation: Missing requirements for upload",{canStartUpload:e(B),hasSeriesId:!!s.seriesId,nonDeletedChapters:e(ue).length}),t.guidedState.setZipStatus(t.zipFile,oe.WARNING),t.onProcessingComplete("warning"))}function we(){return _.apiToken?s.seriesId?s.chapterStates.length===0?(alert("No chapters to upload"),!1):!e(B)||e(ue).length===0?!1:(u(d,m.UPLOADING,!0),t.guidedState.setZipStatus(t.zipFile,oe.PROCESSING),!0):(alert("Please set a series ID first"),!1):(alert("Please set up API authentication first"),!1)}Re(()=>{if(e(d)===m.UPLOADING&&R?.isActive&&e(H)){const p=setTimeout(()=>{console.log("Automation: Triggering upload via UploaderOrchestrator"),e(H)?.startUpload()},200);return()=>clearTimeout(p)}});const B=be(()=>e(d)===m.READY||e(d)===m.READY_WARNING),ue=be(()=>e(T).filter(p=>!p.isDeleted));Re(()=>{if(e(d)===m.UPLOADING&&e(T).length>0){const p=e(T).every(v=>v.status===pt.COMPLETED||v.isDeleted),g=e(T).some(v=>!v.isDeleted);if(p&&g){const I=!e(T).some(P=>!P.isDeleted&&P.status===pt.FAILED);t.guidedState.setZipStatus(t.zipFile,I?oe.COMPLETED:oe.ERROR),fe(I)}}});var Pe={hasIssues:ie,getIssueDetails:ge,isReady:he,startUpload:we},Ce=da(),Ge=r(Ce),je=r(Ge);i(Ge);var Ze=o(Ge,2);{var $e=p=>{var g=Xs(),v=o(r(g),2),I=r(v,!0);i(v);var P=o(v,2);{var S=x=>{var n=Ks(),f=r(n);i(n),W(()=>N(f,`Processing: ${e(z)??""}`)),h(x,n)};G(P,x=>{e(z)&&x(S)})}i(g),W(()=>N(I,e(d)===m.LOADING?"Loading manga folder...":e(d)===m.EXTRACTING?"Extracting zip files...":e(d)===m.SERIES_LOOKUP?"Looking up series ID...":e(d)===m.APPLYING_REGEX?"Applying regex patterns...":e(d)===m.CHAPTER_LOOKUP?"Loading chapter dump...":e(d)===m.LOADING_GROUPS?"Loading groups...":e(d)===m.APPLYING_GROUPS?"Applying groups to chapters...":"Applying titles to chapters...")),h(p,g)},Je=p=>{var g=Me(),v=De(g);{var I=S=>{var x=ua(),n=r(x),f=r(n),l=r(f);i(f),i(n);var c=o(n,2),E=o(r(c),2);Qt(E,{});var Z=o(E,2);es(Z,{});var y=o(Z,2);ts(y,{}),i(c);var O=o(c,2);{var $=me=>{var pe=aa(),ye=r(pe);{var Le=Y=>{var J=$s();h(Y,J)},Ye=Y=>{var J=Js();h(Y,J)};G(ye,Y=>{s.seriesId?Y(Ye,!1):Y(Le)})}var Ve=o(ye,2),rt=r(Ve);{var nt=Y=>{var J=Qs(),Oe=r(J);i(J),W(()=>N(Oe,`‚Ä¢ ${e(M).length??""} duplicate chapter${e(M).length===1?"":"s"} detected`)),h(Y,J)};G(rt,Y=>{e(M).length>0&&Y(nt)})}var qe=o(rt,2);{var ot=Y=>{var J=ea();h(Y,J)};G(qe,Y=>{e(K)&&e(A).length===0&&e(C)===0&&Y(ot)})}var _e=o(qe,2);{var ct=Y=>{var J=ta(),Oe=r(J);i(J),W(dt=>N(Oe,`‚Ä¢ ${e(A).length??""} group${e(A).length===1?"":"s"} failed to lookup: ${dt??""}`),[()=>e(A).join(", ")]),h(Y,J)};G(_e,Y=>{e(A).length>0&&Y(ct)})}var Be=o(_e,2);{var et=Y=>{var J=sa(),Oe=r(J);i(J),W(()=>N(Oe,`‚Ä¢ ${e(C)??""} chapter title${e(C)===1?"":"s"} failed
								to resolve`)),h(Y,J)};G(Be,Y=>{e(C)>0&&Y(et)})}i(Ve),i(pe),h(me,pe)};G(O,me=>{e(d)===m.READY_WARNING&&me($)})}var L=o(O,2);{var re=me=>{var pe=la(),ye=r(pe),Le=r(ye),Ye=r(Le),Ve=r(Ye);i(Ye),Rt(2),i(Le);var rt=o(Le,2);rt.__click=()=>{for(const{chapter:qe}of e(M))qe.isDeleted=!0},i(ye);var nt=o(ye,2);Ue(nt,21,()=>e(M),We,(qe,ot)=>{let _e=()=>e(ot).chapter,ct=()=>e(ot).existingGroups;var Be=oa(),et=r(Be),Y=r(et),J=r(Y),Oe=r(J);i(J);var dt=o(J,2);{var It=Se=>{var st=ia();h(Se,st)};G(dt,Se=>{_e().isDeleted&&Se(It)})}i(Y);var ht=o(Y,2),Nt=r(ht);i(ht),i(et);var tt=o(et,2);tt.__click=()=>{_e().isDeleted=!_e().isDeleted};var St=r(tt);{var At=Se=>{var st=ra();h(Se,st)},yt=Se=>{var st=na();h(Se,st)};G(St,Se=>{_e().isDeleted?Se(At):Se(yt,!1)})}i(tt),i(Be),W(Se=>{Ee(Be,1,`uno-ecxsrr ${_e().isDeleted?"uno-1ya9ju":""}`),N(Oe,`Vol. ${_e().chapterVolume??"N/A"??""} Ch. ${_e().chapterNumber??"N/A"??""} - ${(_e().chapterTitle||_e().originalFolderPath||"Untitled")??""}`),N(Nt,`Existing groups: ${Se??""}`),Ee(tt,1,`uno-v1bdur ${_e().isDeleted?"uno-uigj71":"uno-8ta9ap"}`),ft(tt,"title",_e().isDeleted?"Restore chapter":"Mark as removed")},[()=>ct().join(", ")]),h(qe,Be)}),i(nt),i(pe),W(()=>N(Ve,`‚ö†Ô∏è Warning: ${e(M).length??""} duplicate chapter${e(M).length===1?"":"s"} detected`)),h(me,pe)};G(L,me=>{e(M).length>0&&me(re)})}var ne=o(L,2),xe=o(r(ne),2);Ue(xe,21,()=>e(T),We,(me,pe,ye)=>{Bs(me,{index:ye,get chapter(){return e(pe)}})}),i(xe),i(ne);var Ne=o(ne,2);Ne.__click=we;var Qe=r(Ne);i(Ne),i(x),W(()=>{N(l,`Found ${e(T).length??""} chapter${e(T).length===1?"":"s"} from deepest folders`),Ne.disabled=!e(B)||!s.seriesId||e(ue).length===0,N(Qe,`Start Upload (${e(ue).length??""} of ${e(T).length??""} chapters)`)}),h(S,x)},P=S=>{var x=Me(),n=De(x);{var f=c=>{it(ss(c,{onDone:fe,get busy(){return e(k)},set busy(E){u(k,E,!0)}}),E=>u(H,E,!0),()=>e(H))},l=c=>{var E=Me(),Z=De(E);{var y=O=>{var $=ca();h(O,$)};G(Z,O=>{e(d)===m.COMPLETED&&O(y)},!0)}h(c,E)};G(n,c=>{e(d)===m.UPLOADING?c(f):c(l,!1)},!0)}h(S,x)};G(v,S=>{e(d)===m.READY||e(d)===m.READY_WARNING?S(I):S(P,!1)},!0)}h(p,g)};G(Ze,p=>{e(d)===m.LOADING||e(d)===m.EXTRACTING||e(d)===m.SERIES_LOOKUP||e(d)===m.APPLYING_REGEX||e(d)===m.CHAPTER_LOOKUP||e(d)===m.LOADING_GROUPS||e(d)===m.APPLYING_GROUPS||e(d)===m.APPLYING_TITLES?p($e):p(Je,!1)})}return i(Ce),W(()=>{Ee(Ce,1,`uno-hemz07 ${a()??""}`),N(je,`Processing: ${t.zipFile.name??""}`)}),h(b,Ce),Ke(Pe)}Xe(["click"]);var va=w('<div class="uno-j48514"><p class="uno-5v04yw">No zip file selected. Use the tabs above to select a zip file to process.</p></div>'),fa=w('<div class="uno-eeu1av"><!> <!></div>'),ga=w('<div class="uno-pb4e2u"><div class="uno-k0pcvl"><h1 class="uno-kryzyj">Guided Zip Manga Uploader</h1> <div class="uno-skt2gn"><button type="button" class="uno-q7l7gr">Simple Mode</button> <!></div></div> <a target="_blank" class="uno-6zhxse">Tutorial & Docs</a> <!> <!></div>');function ya(b,t){He(t,!0);const a=new us,s=new cs;lt(ds,a),lt(gt,s),lt(xt,new rs);let _=D(null),R=D(null);function d(){a.workflowStep=ke.SELECTING_MANGA_FOLDERS}function Q(){if(a.workflowStep=ke.PROCESSING_MANGA,a.selectedZipFiles.length>0){const F=a.selectedZipFiles[0],j=a.zipFiles.findIndex(te=>te.file===F);j>=0&&(a.currentZipIndex=j,u(_,F,!0))}}function T(F){u(_,F,!0)}function k(F){const j=a.currentZip;if(j&&(F==="success"?a.setZipStatus(j.file,oe.COMPLETED):F==="warning"?a.setZipStatus(j.file,oe.WARNING):F==="error"&&a.setZipStatus(j.file,oe.ERROR)),a.moveToNextZip()){const te=a.currentZip;te&&u(_,te.file,!0)}else u(_,null)}function z(){e(R)&&e(R).startUpload()}const H=be(()=>a.workflowStep!==ke.PROCESSING_MANGA);var se=ga(),M=r(se),K=o(r(M),2),A=r(K);A.__click=()=>os(_t("/"));var C=o(A,2);as(C,{}),i(K),i(M);var ee=o(M,2),U=o(ee,2);{var V=F=>{is(F,{})};G(U,F=>{e(H)&&F(V)})}var ae=o(U,2);{var X=F=>{gs(F,{get guidedState(){return a},onDone:d,class:"uno-zgouyr"})},q=F=>{var j=Me(),te=De(j);{var Ae=le=>{bs(le,{get guidedState(){return a},onDone:Q,class:"uno-l0uum8"})},ve=le=>{var Ie=Me(),de=De(Ie);{var ce=fe=>{var ie=fa(),ge=r(ie);Ds(ge,{get guidedState(){return a},onZipSelected:T,onAutomationRequestUpload:z,get mangaProcessorRef(){return e(R)},class:"uno-wgeun8"});var he=o(ge,2);{var Fe=B=>{it(pa(B,{get guidedState(){return a},get zipFile(){return e(_)},onProcessingComplete:k,class:"uno-wgeun8"}),ue=>u(R,ue,!0),()=>e(R))},we=B=>{var ue=va();h(B,ue)};G(he,B=>{e(_)?B(Fe):B(we,!1)})}i(ie),h(fe,ie)};G(de,fe=>{a.workflowStep===ke.PROCESSING_MANGA&&fe(ce)},!0)}h(le,Ie)};G(te,le=>{a.workflowStep===ke.SELECTING_MANGA_FOLDERS?le(Ae):le(ve,!1)},!0)}h(F,j)};G(ae,F=>{a.workflowStep===ke.SELECTING_ROOT_FOLDER?F(X):F(q,!1)})}i(se),W(F=>ft(ee,"href",F),[()=>_t("/docs")]),h(b,se),Ke()}Xe(["click"]);export{ya as component,Aa as universal};
